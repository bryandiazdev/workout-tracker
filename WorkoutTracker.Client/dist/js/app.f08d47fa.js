(()=>{"use strict";var e={139:(e,t,o)=>{var s=o(751),a=o(220),r=o(278),n=o(641),i=o(33);const l={class:"app"},c={key:0,id:"auth-debug",class:"auth-debug-panel"},u={class:"app-header"},d={class:"container"},g={class:"logo"},h={key:0},p={key:1},m={class:"container"},k={class:"app-footer"},f={class:"container"};function y(e,t,o,a,r,y){const v=(0,n.g2)("router-link"),w=(0,n.g2)("router-view"),L=(0,n.g2)("Notification");return(0,n.uX)(),(0,n.CE)("div",l,[a.showAuthDebug?((0,n.uX)(),(0,n.CE)("div",c,[t[5]||(t[5]=(0,n.Lk)("h3",null,"Auth Debug Info",-1)),(0,n.Lk)("p",null,[t[2]||(t[2]=(0,n.Lk)("strong",null,"Authenticated:",-1)),(0,n.eW)(" "+(0,i.v_)(a.isAuthenticated),1)]),(0,n.Lk)("p",null,[t[3]||(t[3]=(0,n.Lk)("strong",null,"Token:",-1)),(0,n.eW)(" "+(0,i.v_)(a.hasToken?"Present":"None"),1)]),(0,n.Lk)("p",null,[t[4]||(t[4]=(0,n.Lk)("strong",null,"User:",-1)),(0,n.eW)(" "+(0,i.v_)(a.hasUser?"Loaded":"None"),1)]),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.closeDebugPanel&&a.closeDebugPanel(...e))},"Close")])):(0,n.Q3)("",!0),(0,n.Lk)("header",u,[(0,n.Lk)("div",d,[(0,n.Lk)("div",g,[(0,n.bF)(v,{to:"/"},{default:(0,n.k6)((()=>t[6]||(t[6]=[(0,n.Lk)("h1",null,"WorkoutTracker",-1)]))),_:1})]),e.$store.state.isAuthenticated?((0,n.uX)(),(0,n.CE)("nav",h,[(0,n.bF)(v,{to:"/dashboard"},{default:(0,n.k6)((()=>t[7]||(t[7]=[(0,n.eW)("Dashboard")]))),_:1}),(0,n.bF)(v,{to:"/workout-plans"},{default:(0,n.k6)((()=>t[8]||(t[8]=[(0,n.eW)("Workout Plans")]))),_:1}),(0,n.bF)(v,{to:"/workout-logs"},{default:(0,n.k6)((()=>t[9]||(t[9]=[(0,n.eW)("Workout Logs")]))),_:1}),(0,n.bF)(v,{to:"/goals"},{default:(0,n.k6)((()=>t[10]||(t[10]=[(0,n.eW)("Goals")]))),_:1}),(0,n.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,s.D$)(((...e)=>a.logout&&a.logout(...e)),["prevent"]))},"Logout")])):((0,n.uX)(),(0,n.CE)("nav",p,[(0,n.bF)(v,{to:"/login"},{default:(0,n.k6)((()=>t[11]||(t[11]=[(0,n.eW)("Login")]))),_:1})]))])]),(0,n.Lk)("main",m,[(0,n.bF)(w)]),(0,n.Lk)("footer",k,[(0,n.Lk)("div",f,[(0,n.Lk)("p",null,"© "+(0,i.v_)(y.currentYear)+" WorkoutTracker. All rights reserved.",1)])]),(0,n.bF)(L)])}var v=o(377);class w{constructor(){this.maxLogEntries=100,this.logStorageKey="workout_tracker_debug_logs"}getLogs(){try{const e=localStorage.getItem(this.logStorageKey);return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing debug logs:",e),[]}}log(e,t,o=null){try{const s=this.getLogs(),a=(new Date).toISOString();s.push({timestamp:a,category:e,message:t,data:o?JSON.stringify(o):null}),s.length>this.maxLogEntries&&s.splice(0,s.length-this.maxLogEntries),localStorage.setItem(this.logStorageKey,JSON.stringify(s)),console.log(`[${e}] ${t}`,o||"")}catch(s){console.error("Error storing debug log:",s)}}clearLogs(){localStorage.removeItem(this.logStorageKey)}logAuth(e,t=null){this.log("AUTH",e,t)}logApi(e,t=null){this.log("API",e,t)}logNavigation(e,t=null){this.log("NAVIGATION",e,t)}}const L=new w,b=L,D=()=>{if({VUE_APP_API_URL:"/api",VUE_APP_AUTH0_DOMAIN:"dev-47c4icnwccbjdiz5.us.auth0.com",VUE_APP_AUTH0_CLIENT_ID:"6VxrjlK5YXdXm9FVX2GFPpBdwDShwuTc",VUE_APP_AUTH0_AUDIENCE:"https://workouttracker-api",NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AUTH0_CALLBACK_URL)return{VUE_APP_API_URL:"/api",VUE_APP_AUTH0_DOMAIN:"dev-47c4icnwccbjdiz5.us.auth0.com",VUE_APP_AUTH0_CLIENT_ID:"6VxrjlK5YXdXm9FVX2GFPpBdwDShwuTc",VUE_APP_AUTH0_AUDIENCE:"https://workouttracker-api",NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AUTH0_CALLBACK_URL;{const e=window.location.origin;return`${e}/callback`}};class A{constructor(){const e=D();console.log("Auth0 Configuration:"),console.log("Domain:","dev-47c4icnwccbjdiz5.us.auth0.com"),console.log("Client ID:","[SET]"),console.log("Audience:","https://workouttracker-api"),console.log("Redirect URI:",e),b.logAuth("Auth0 Configuration initialized",{domain:"dev-47c4icnwccbjdiz5.us.auth0.com",clientIdSet:!0,audience:"https://workouttracker-api",redirectUri:e}),this.auth0=new v.Ay.WebAuth({domain:"dev-47c4icnwccbjdiz5.us.auth0.com",clientID:"6VxrjlK5YXdXm9FVX2GFPpBdwDShwuTc",redirectUri:e,audience:"https://workouttracker-api",responseType:"token id_token",scope:"openid profile email"}),this.login=this.login.bind(this),this.logout=this.logout.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this),this.getToken=this.getToken.bind(this),this.getUser=this.getUser.bind(this)}login(){console.log("Initiating Auth0 login flow..."),b.logAuth("Initiating Auth0 login flow");const e=this.generateRandomString();localStorage.setItem("auth_state",e),console.log("Auth0 config being used:",{domain:this.auth0.baseOptions.domain,clientID:this.auth0.baseOptions.clientID,redirectUri:this.auth0.baseOptions.redirectUri,audience:this.auth0.baseOptions.audience,responseType:this.auth0.baseOptions.responseType,scope:this.auth0.baseOptions.scope,state:e}),b.logAuth("Auth0 configuration for login",{domain:this.auth0.baseOptions.domain,clientIDLength:this.auth0.baseOptions.clientID.length,redirectUri:this.auth0.baseOptions.redirectUri,audience:this.auth0.baseOptions.audience,responseType:this.auth0.baseOptions.responseType,scope:this.auth0.baseOptions.scope,state:e.substring(0,5)+"..."});const t=`https://dev-47c4icnwccbjdiz5.us.auth0.com/authorize?client_id=6VxrjlK5YXdXm9FVX2GFPpBdwDShwuTc&response_type=token id_token&redirect_uri=${encodeURIComponent(this.auth0.baseOptions.redirectUri)}&scope=openid profile email&audience=${encodeURIComponent("https://workouttracker-api")}&state=${e}&nonce=${this.generateRandomString()}`;console.log("Redirecting to Auth0 login page with URL:",t),b.logAuth("Redirecting to Auth0 login page"),window.location.href=t}generateRandomString(){const e=window.crypto||window.msCrypto,t=new Uint32Array(5);return e.getRandomValues(t),Array.from(t).map((e=>e.toString(36))).join("")}handleAuthentication(){return console.log("Starting Auth0 parseHash to handle authentication..."),b.logAuth("Starting authentication handler"),new Promise(((e,t)=>{try{const s=window.location.hash;if(console.log("Auth0 parseHash called with window.location.hash:",s),b.logAuth("Processing authentication callback",{hasHash:!!s,hashLength:s?s.length:0,url:window.location.href.replace(/access_token=([^&]+)/,"access_token=REDACTED")}),!s||s.length<2)return console.warn("No hash present in URL, cannot authenticate"),b.logAuth("No hash present in URL, cannot authenticate"),void e(!1);if(s.includes("access_token=")&&s.includes("id_token=")){console.log("Attempting manual token extraction from hash"),b.logAuth("Attempting manual token extraction from hash");try{const t={};s.substring(1).split("&").forEach((e=>{const[o,s]=e.split("=");t[o]=decodeURIComponent(s)})),console.log("Extracted hash params:",Object.keys(t)),b.logAuth("Extracted hash params",{keys:Object.keys(t),hasAccessToken:!!t.access_token,hasIdToken:!!t.id_token,hasState:!!t.state,hasExpiresIn:!!t.expires_in});const o=localStorage.getItem("auth_state");if(o!==t.state)return console.error("State parameter mismatch - possible CSRF attack"),b.logAuth("State parameter mismatch - possible CSRF attack",{originalState:o?o.substring(0,5)+"...":"null",receivedState:t.state?t.state.substring(0,5)+"...":"null"}),void e(!1);const a={accessToken:t.access_token,idToken:t.id_token,expiresIn:parseInt(t.expires_in||"3600"),idTokenPayload:this.parseJwt(t.id_token)};return console.log("Manual authentication successful, setting session..."),b.logAuth("Manual authentication successful, setting session"),this.setSession(a),void e(!0)}catch(o){console.error("Manual token extraction failed:",o),b.logAuth("Manual token extraction failed",{error:o.message,stack:o.stack})}}this.auth0.parseHash(((o,s)=>{console.log("parseHash callback executed"),b.logAuth("Auth0 parseHash callback executed"),s&&s.accessToken&&s.idToken?(console.log("Authentication successful, setting session..."),console.log("Auth tokens received:",{accessToken:s.accessToken?"Present (not showing for security)":"Missing",idToken:s.idToken?"Present (not showing for security)":"Missing",expiresIn:s.expiresIn}),b.logAuth("Authentication successful",{hasAccessToken:!!s.accessToken,hasIdToken:!!s.idToken,expiresIn:s.expiresIn}),this.setSession(s),e(!0)):o?(console.error("Authentication error:",o),console.error("Error details:",JSON.stringify(o,null,2)),b.logAuth("Authentication error",{error:o.error||"unknown_error",errorDescription:o.errorDescription||"No description",statusCode:o.statusCode}),"invalid_grant"===o.error?(console.error("Invalid grant - this could be due to expired authorization code or already used code"),b.logAuth("Invalid grant error")):"unauthorized"===o.error&&(console.error("Unauthorized - check audience, client ID permissions"),b.logAuth("Unauthorized error")),t(o)):(console.warn("No authentication result or error received"),console.warn("This might happen if the callback URL does not match what was configured in Auth0"),console.warn("Check that http://localhost:8080/callback is set up correctly in Auth0 dashboard"),b.logAuth("No authentication result or error received"),e(!1))}))}catch(s){console.error("Error calling parseHash:",s),b.logAuth("Error calling parseHash",{error:s.message,stack:s.stack}),t(s)}}))}parseJwt(e){try{const t=e.split(".")[1],o=t.replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(o).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(s)}catch(t){return console.error("Error parsing JWT:",t),b.logAuth("Error parsing JWT",{error:t.message}),{}}}setSession(e){const t=JSON.stringify(1e3*e.expiresIn+(new Date).getTime());localStorage.setItem("auth_token",e.accessToken),localStorage.setItem("id_token",e.idToken),localStorage.setItem("expires_at",t),localStorage.setItem("user_profile",JSON.stringify(e.idTokenPayload)),b.logAuth("Authentication session set",{expiresAt:new Date(JSON.parse(t)).toLocaleString(),hasAccessToken:!!e.accessToken,hasIdToken:!!e.idToken,hasUserProfile:!!e.idTokenPayload})}logout(){return new Promise(((e,t)=>{try{localStorage.removeItem("auth_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),localStorage.removeItem("user_profile"),localStorage.removeItem("user_state"),localStorage.removeItem("auth_state"),console.log("Logout complete: cleared all auth-related localStorage items"),b.logAuth("Logout complete: cleared all auth-related localStorage items"),console.log("Using client-side logout approach"),b.logAuth("Using client-side logout approach"),sessionStorage.setItem("performed_client_logout","true"),e()}catch(o){console.error("Error during logout process:",o),b.logAuth("Error during logout process",{error:o.message}),t(o)}}))}isAuthenticated(){const e=JSON.parse(localStorage.getItem("expires_at")||"0"),t=localStorage.getItem("auth_token"),o=(new Date).getTime(),s=o>=e,a=o<e&&!!t;return console.log("Detailed Auth check:",{hasToken:!!t,expiresAt:e?new Date(e).toLocaleString():"not set",currentTime:new Date(o).toLocaleString(),isExpired:s,timeRemaining:e?Math.floor((e-o)/1e3/60)+" minutes":"N/A",isAuthenticated:a}),a}getToken(){return localStorage.getItem("auth_token")}async getUser(){const e=localStorage.getItem("user_profile");if(e)return b.logAuth("Retrieved user from localStorage"),JSON.parse(e);try{b.logAuth("Fetching user data from API");const e="/api",t=await fetch(`${e}/Users/me`,{headers:{Authorization:`Bearer ${this.getToken()}`}});if(t.ok){const e=await t.json();return b.logAuth("User data fetched successfully from API"),e}throw b.logAuth("Failed to fetch user from API",{status:t.status,statusText:t.statusText}),new Error("Failed to fetch user")}catch(t){return console.error("Error fetching user:",t),b.logAuth("Error fetching user",{error:t.message,stack:t.stack}),null}}resetPassword(e){return new Promise(((t,o)=>{this.auth0.changePassword({connection:"Username-Password-Authentication",email:e},((e,s)=>{e?o(e):t(s)}))}))}}const C=new A,E=C,S={class:"notification-content"};function P(e,t,o,a,r,l){return(0,n.uX)(),(0,n.Wv)(s.eB,{name:"notification-fade"},{default:(0,n.k6)((()=>[e.notification.show?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,i.C4)(["notification",`notification-${e.notification.type}`])},[(0,n.Lk)("div",S,[(0,n.Lk)("span",null,(0,i.v_)(e.notification.message),1),(0,n.Lk)("button",{class:"notification-close",onClick:t[0]||(t[0]=(...t)=>e.hideNotification&&e.hideNotification(...t))},"×")])],2)):(0,n.Q3)("",!0)])),_:1})}const T={name:"Notification",computed:{...(0,r.aH)(["notification"])},methods:{...(0,r.PY)(["hideNotification"])}};var I=o(262);const x=(0,I.A)(T,[["render",P],["__scopeId","data-v-5a87d910"]]),F=x;var U=o(953);const _={name:"App",components:{Notification:F},setup(){const e=(0,r.Pj)(),t=(0,a.rd)(),o=(0,U.KR)(!1),s=(0,n.EW)((()=>E.isAuthenticated())),i=(0,n.EW)((()=>!!E.getToken())),l=(0,n.EW)((()=>!!e.state.user)),c=()=>{i.value&&!l.value&&(o.value=!0)},u=()=>{o.value=!1};(0,n.sV)((()=>{console.log("App.vue mounted - checking authentication state");const t=localStorage.getItem("auth_token"),o=localStorage.getItem("id_token"),s=localStorage.getItem("user_profile");console.log("Initial auth state:",{hasToken:!!t,hasIdToken:!!o,hasUserProfile:!!s,isAuthenticated:E.isAuthenticated(),hasUserInStore:!!e.state.user}),E.isAuthenticated()?(console.log("User is authenticated, ensuring user data is loaded"),e.commit("setAuthenticated",!0),s&&!e.state.user?(console.log("Loading user profile from localStorage to Vuex store"),e.commit("setUser",JSON.parse(s))):t&&!s&&(console.log("Fetching user data from API"),e.dispatch("fetchUser").catch((e=>{console.error("Failed to fetch user data on app init:",e)})))):e.commit("setAuthenticated",!1),setTimeout(c,5e3)}));const d=async()=>{try{await e.dispatch("logout"),t.push("/login")}catch(o){o&&o.message&&o.message.includes("returnTo")?(console.error("Auth0 logout error related to returnTo URL configuration:",o),t.push("/auth-config?error=invalid_request&error_description="+encodeURIComponent(o.message))):(console.error("Logout error:",o),e.dispatch("showMessage",{message:"There was an issue during logout. Your session may not be fully cleared.",type:"error"}),t.push("/login"))}};return{isAuthenticated:s,hasToken:i,hasUser:l,showAuthDebug:o,closeDebugPanel:u,logout:d}},computed:{...(0,r.aH)(["user","isAuthenticated"]),currentYear(){return(new Date).getFullYear()}}},V=(0,I.A)(_,[["render",y]]),$=V,N={class:"home"},M={class:"hero"},W={class:"hero-content"},G={class:"hero-buttons"},O={class:"cta"};function R(e,t,o,s,a,r){const i=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",N,[(0,n.Lk)("section",M,[(0,n.Lk)("div",W,[t[2]||(t[2]=(0,n.Lk)("h1",null,"Track Your Fitness Journey",-1)),t[3]||(t[3]=(0,n.Lk)("p",null," WorkoutTracker helps you track your workouts, monitor progress, and achieve your fitness goals. ",-1)),(0,n.Lk)("div",G,[(0,n.bF)(i,{to:"/login",class:"btn btn-primary btn-lg"},{default:(0,n.k6)((()=>t[0]||(t[0]=[(0,n.eW)("Get Started")]))),_:1}),t[1]||(t[1]=(0,n.Lk)("a",{href:"#features",class:"btn btn-outline btn-lg"},"Learn More",-1))])]),t[4]||(t[4]=(0,n.Lk)("div",{class:"hero-image"},[(0,n.Lk)("img",{src:"https://images.unsplash.com/photo-1579126038374-6064e9370f0f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",alt:"Workout"})],-1))]),t[8]||(t[8]=(0,n.Fv)('<section id="features" class="features" data-v-3fe9c414><h2 class="section-title" data-v-3fe9c414>Features</h2><div class="feature-grid" data-v-3fe9c414><div class="feature-card" data-v-3fe9c414><div class="feature-icon" data-v-3fe9c414><i class="fas fa-calendar-alt" data-v-3fe9c414></i></div><h3 data-v-3fe9c414>Workout Plans</h3><p data-v-3fe9c414>Create and customize workout plans to fit your fitness goals and schedule.</p></div><div class="feature-card" data-v-3fe9c414><div class="feature-icon" data-v-3fe9c414><i class="fas fa-chart-line" data-v-3fe9c414></i></div><h3 data-v-3fe9c414>Progress Tracking</h3><p data-v-3fe9c414>Track your progress with visual charts and detailed statistics.</p></div><div class="feature-card" data-v-3fe9c414><div class="feature-icon" data-v-3fe9c414><i class="fas fa-bullseye" data-v-3fe9c414></i></div><h3 data-v-3fe9c414>Goal Setting</h3><p data-v-3fe9c414>Set personal fitness goals and track your journey to achieving them.</p></div><div class="feature-card" data-v-3fe9c414><div class="feature-icon" data-v-3fe9c414><i class="fas fa-history" data-v-3fe9c414></i></div><h3 data-v-3fe9c414>Workout History</h3><p data-v-3fe9c414>Keep a detailed log of your workout history to analyze your performance over time.</p></div></div></section><section class="how-it-works" data-v-3fe9c414><h2 class="section-title" data-v-3fe9c414>How It Works</h2><div class="steps" data-v-3fe9c414><div class="step" data-v-3fe9c414><div class="step-number" data-v-3fe9c414>1</div><h3 data-v-3fe9c414>Create an Account</h3><p data-v-3fe9c414>Sign up with Auth0 secure authentication to get started.</p></div><div class="step" data-v-3fe9c414><div class="step-number" data-v-3fe9c414>2</div><h3 data-v-3fe9c414>Create Workout Plans</h3><p data-v-3fe9c414>Design custom workout plans with exercises tailored to your needs.</p></div><div class="step" data-v-3fe9c414><div class="step-number" data-v-3fe9c414>3</div><h3 data-v-3fe9c414>Log Your Workouts</h3><p data-v-3fe9c414>Record your completed workouts and track your progress.</p></div><div class="step" data-v-3fe9c414><div class="step-number" data-v-3fe9c414>4</div><h3 data-v-3fe9c414>Achieve Your Goals</h3><p data-v-3fe9c414>Set goals, monitor your progress, and celebrate your achievements.</p></div></div></section>',2)),(0,n.Lk)("section",O,[t[6]||(t[6]=(0,n.Lk)("h2",null,"Ready to Start Your Fitness Journey?",-1)),t[7]||(t[7]=(0,n.Lk)("p",null,"Join WorkoutTracker today and take control of your fitness goals.",-1)),(0,n.bF)(i,{to:"/login",class:"btn btn-primary btn-lg"},{default:(0,n.k6)((()=>t[5]||(t[5]=[(0,n.eW)("Get Started Now")]))),_:1})])])}const q={name:"Home"},X=(0,I.A)(q,[["render",R],["__scopeId","data-v-3fe9c414"]]),J=X,j={class:"login-container"},H={class:"card"},B={class:"card-body"},z={key:0,class:"alert alert-danger"},K={class:"login-methods"},Y={class:"login-footer"};function Q(e,t,o,a,r,l){return(0,n.uX)(),(0,n.CE)("div",j,[(0,n.Lk)("div",H,[t[4]||(t[4]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",{class:"card-title"},"Login to WorkoutTracker")],-1)),(0,n.Lk)("div",B,[t[2]||(t[2]=(0,n.Lk)("p",{class:"mb-4"}," Track your fitness journey, set goals, and monitor your progress with WorkoutTracker. ",-1)),a.authError?((0,n.uX)(),(0,n.CE)("div",z,(0,i.v_)(a.authError),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",K,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.regularLogin&&a.regularLogin(...e)),class:"btn btn-primary btn-block"}," Login with Auth0 ")]),t[3]||(t[3]=(0,n.Lk)("div",{class:"mt-4"},[(0,n.Lk)("p",{class:"text-center"}," By logging in, you agree to our Terms of Service and Privacy Policy. ")],-1))])]),(0,n.Lk)("div",Y,[(0,n.Lk)("p",null,[t[5]||(t[5]=(0,n.eW)("Don't have an account? ")),(0,n.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,s.D$)(((...e)=>a.regularLogin&&a.regularLogin(...e)),["prevent"]))},"Sign up")])])])}const Z={name:"Login",setup(){const e=(0,U.KR)(""),t=(0,U.KR)(!1),o="dev-47c4icnwccbjdiz5.us.auth0.com",s="6VxrjlK5YXdXm9FVX2GFPpBdwDShwuTc",a="http://localhost:8080/callback",r="https://workouttracker-api",n=()=>{try{E.login()}catch(t){console.error("Login error:",t),e.value="Failed to initialize login. Please try again or use the direct login method."}},i=()=>{try{const e=l();localStorage.setItem("auth_state",e);const t=l();localStorage.setItem("auth_nonce",t);const n=`https://${o}/authorize?client_id=${encodeURIComponent(s)}&response_type=token%20id_token&redirect_uri=${encodeURIComponent(a)}&scope=${encodeURIComponent("openid profile email")}&audience=${encodeURIComponent(r)}&state=${encodeURIComponent(e)}&nonce=${encodeURIComponent(t)}`;console.log("Direct login URL:",n),window.location.href=n}catch(t){console.error("Direct login error:",t),e.value="Failed to initialize direct login. Please try again."}},l=()=>{const e=window.crypto||window.msCrypto,t=new Uint32Array(5);return e.getRandomValues(t),Array.from(t).map((e=>e.toString(36))).join("")};return{authError:e,showDebug:t,authDomain:o,clientId:s,callbackUrl:a,audience:r,regularLogin:n,directLogin:i}}},ee=(0,I.A)(Z,[["render",Q],["__scopeId","data-v-36c8e612"]]),te=ee,oe={class:"dashboard"},se={key:0,class:"loading"},ae={key:1},re={key:0,class:"welcome-card"},ne={class:"welcome-content"},ie={class:"chart-grid"},le={class:"chart-card"},ce={class:"chart-container"},ue={ref:"frequencyChart"},de={class:"chart-card"},ge={class:"chart-container"},he={ref:"durationChart"},pe={class:"chart-card"},me={class:"chart-container"},ke={ref:"exerciseTypesChart"},fe={class:"chart-card"},ye={class:"chart-container"},ve={ref:"muscleGroupsChart"},we={class:"goals-section"},Le={key:0,class:"no-data"},be={key:1,class:"goals-list"},De={class:"goal-info"},Ae={class:"goal-target"},Ce={class:"goal-dates"},Ee={class:"goal-progress"},Se={class:"progress-bar"},Pe={class:"progress-text"},Te={class:"view-all"},Ie={class:"recent-workouts"},xe={key:0,class:"no-data"},Fe={key:1,class:"recent-list"},Ue={class:"workout-date"},_e={class:"workout-details"},Ve={key:0,class:"workout-notes"},$e={class:"view-all"};function Ne(e,t,o,s,a,r){const l=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",oe,[t[14]||(t[14]=(0,n.Lk)("h1",{class:"page-title"},"Dashboard",-1)),a.loading?((0,n.uX)(),(0,n.CE)("div",se,t[0]||(t[0]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Loading your fitness data...",-1)]))):((0,n.uX)(),(0,n.CE)("div",ae,[e.user?((0,n.uX)(),(0,n.CE)("div",re,[(0,n.Lk)("div",ne,[(0,n.Lk)("h2",null,"Welcome back, "+(0,i.v_)(e.user.name)+"!",1),t[1]||(t[1]=(0,n.Lk)("p",null,"Track your progress and stay motivated on your fitness journey.",-1))])])):(0,n.Q3)("",!0),(0,n.Lk)("div",ie,[(0,n.Lk)("div",le,[t[2]||(t[2]=(0,n.Lk)("h3",{class:"chart-title"},"Workout Frequency",-1)),(0,n.Lk)("div",ce,[(0,n.Lk)("canvas",ue,null,512)])]),(0,n.Lk)("div",de,[t[3]||(t[3]=(0,n.Lk)("h3",{class:"chart-title"},"Workout Duration",-1)),(0,n.Lk)("div",ge,[(0,n.Lk)("canvas",he,null,512)])]),(0,n.Lk)("div",pe,[t[4]||(t[4]=(0,n.Lk)("h3",{class:"chart-title"},"Exercise Types",-1)),(0,n.Lk)("div",me,[(0,n.Lk)("canvas",ke,null,512)])]),(0,n.Lk)("div",fe,[t[5]||(t[5]=(0,n.Lk)("h3",{class:"chart-title"},"Muscle Groups",-1)),(0,n.Lk)("div",ye,[(0,n.Lk)("canvas",ve,null,512)])])]),(0,n.Lk)("div",we,[t[9]||(t[9]=(0,n.Lk)("h2",{class:"section-title"},"Your Goals",-1)),e.goals&&Array.isArray(e.goals)&&0!==e.goals.length?((0,n.uX)(),(0,n.CE)("div",be,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.goalsArray.slice(0,3),(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"goal-card"},[(0,n.Lk)("div",De,[(0,n.Lk)("h3",null,(0,i.v_)(e.name),1),(0,n.Lk)("p",Ae,(0,i.v_)(e.targetValue)+" "+(0,i.v_)(e.unit),1),(0,n.Lk)("p",Ce," From "+(0,i.v_)(r.formatDate(e.startDate))+" to "+(0,i.v_)(r.formatDate(e.targetDate)),1),(0,n.Lk)("div",Ee,[(0,n.Lk)("div",Se,[(0,n.Lk)("div",{class:"progress-fill",style:(0,i.Tr)({width:e.isCompleted?"100%":"0%"})},null,4)]),(0,n.Lk)("p",Pe,(0,i.v_)(e.isCompleted?"Completed!":"In Progress"),1)])])])))),128)),(0,n.Lk)("div",Te,[(0,n.bF)(l,{to:"/goals",class:"btn btn-outline"},{default:(0,n.k6)((()=>t[8]||(t[8]=[(0,n.eW)("View All Goals")]))),_:1})])])):((0,n.uX)(),(0,n.CE)("div",Le,[t[7]||(t[7]=(0,n.Lk)("p",null,"You haven't set any goals yet.",-1)),(0,n.bF)(l,{to:"/goals",class:"btn btn-primary"},{default:(0,n.k6)((()=>t[6]||(t[6]=[(0,n.eW)("Set Your First Goal")]))),_:1})]))]),(0,n.Lk)("div",Ie,[t[13]||(t[13]=(0,n.Lk)("h2",{class:"section-title"},"Recent Workouts",-1)),e.workoutLogs&&Array.isArray(e.workoutLogs)&&0!==e.workoutLogs.length?((0,n.uX)(),(0,n.CE)("div",Fe,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.workoutLogsArray.slice(0,3),(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"workout-card"},[(0,n.Lk)("div",Ue,(0,i.v_)(r.formatDate(e.workoutDate)),1),(0,n.Lk)("div",_e,[(0,n.Lk)("h3",null,(0,i.v_)(e.workoutPlan?e.workoutPlan.name:"Custom Workout"),1),(0,n.Lk)("p",null,"Duration: "+(0,i.v_)(r.formatDuration(e.duration)),1),(0,n.Lk)("p",null,"Exercises: "+(0,i.v_)(e.exerciseLogs?e.exerciseLogs.length:0),1)]),e.notes?((0,n.uX)(),(0,n.CE)("div",Ve,[(0,n.Lk)("p",null,(0,i.v_)(e.notes),1)])):(0,n.Q3)("",!0)])))),128)),(0,n.Lk)("div",$e,[(0,n.bF)(l,{to:"/workout-logs",class:"btn btn-outline"},{default:(0,n.k6)((()=>t[12]||(t[12]=[(0,n.eW)("View All Workouts")]))),_:1})])])):((0,n.uX)(),(0,n.CE)("div",xe,[t[11]||(t[11]=(0,n.Lk)("p",null,"You haven't logged any workouts yet.",-1)),(0,n.bF)(l,{to:"/workout-logs",class:"btn btn-primary"},{default:(0,n.k6)((()=>t[10]||(t[10]=[(0,n.eW)("Log Your First Workout")]))),_:1})]))])]))])}var Me=o(154),We=o(22);We.t1.register(...We.$L);let Ge=!1;const Oe={name:"Dashboard",data(){return{loading:!0,frequencyChart:null,durationChart:null,exerciseTypesChart:null,muscleGroupsChart:null,resizeTimeout:null,chartInstances:[]}},computed:{...(0,r.aH)(["workoutLogs","workoutPlans","goals","stats","user"]),goalsArray(){return Array.isArray(this.goals)?this.goals:[]},workoutLogsArray(){return Array.isArray(this.workoutLogs)?this.workoutLogs:[]}},methods:{formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()},formatDuration(e){if(!e)return"0 min";const t="string"===typeof e?e.match(/PT(?:(\d+)H)?(?:(\d+)M)?/):null;if(t){const e=t[1]?parseInt(t[1]):0,o=t[2]?parseInt(t[2]):0;return e>0?`${e}h ${o}m`:`${o} min`}return"number"===typeof e?`${e} min`:"0 min"},async fetchData(){if(Ge){this.loading=!0;try{if(await Promise.all([this.$store.dispatch("fetchUser"),this.$store.dispatch("fetchWorkoutLogs"),this.$store.dispatch("fetchGoals"),this.$store.dispatch("fetchStats")]),!Ge)return;await this.fetchChartData()}catch(e){console.error("Error fetching dashboard data:",e)}finally{Ge&&(this.loading=!1)}}},async fetchChartData(){if(Ge)try{const e=await this.$store.dispatch("fetchChartData","workout-frequency"),t=await this.$store.dispatch("fetchChartData","workout-duration"),o=await this.$store.dispatch("fetchChartData","exercise-types"),s=await this.$store.dispatch("fetchChartData","muscle-groups");if(!Ge)return;if(e&&Object.keys(e).length>0?this.renderFrequencyChart(e):(console.warn("No workout frequency data available"),this.renderFrequencyChart(this.getDemoFrequencyData())),!Ge)return;if(t&&Object.keys(t).length>0?this.renderDurationChart(t):(console.warn("No workout duration data available"),this.renderDurationChart(this.getDemoDurationData())),!Ge)return;if(o&&Object.keys(o).length>0?this.renderExerciseTypesChart(o):(console.warn("No exercise types data available"),this.renderExerciseTypesChart(this.getDemoExerciseTypesData())),!Ge)return;s&&Object.keys(s).length>0?this.renderMuscleGroupsChart(s):(console.warn("No muscle groups data available"),this.renderMuscleGroupsChart(this.getDemoMuscleGroupsData()))}catch(e){if(!Ge)return;console.error("Error fetching chart data:",e),this.renderFrequencyChart(this.getDemoFrequencyData()),this.renderDurationChart(this.getDemoDurationData()),this.renderExerciseTypesChart(this.getDemoExerciseTypesData()),this.renderMuscleGroupsChart(this.getDemoMuscleGroupsData())}},getDemoFrequencyData(){const e={},t=new Date;for(let o=29;o>=0;o--){const s=new Date;s.setDate(t.getDate()-o);const a=s.toISOString().split("T")[0],r=s.getDay();[1,3,5].includes(r)?e[a]=Math.random()>.2?1:0:[2,4].includes(r)?e[a]=Math.random()>.5?1:0:e[a]=Math.random()>.7?1:0,1===e[a]&&Math.random()>.9&&(e[a]=2)}return e},getDemoDurationData(){const e={},t=(new Date,this.getDemoFrequencyData());return Object.keys(t).forEach((o=>{if(t[o]>0){const s=new Date(o),a=s.getDay();[1,5].includes(a)?e[o]=Math.floor(31*Math.random())+45:[3].includes(a)?e[o]=Math.floor(31*Math.random())+60:[2,4].includes(a)?e[o]=Math.floor(31*Math.random())+30:e[o]=Math.floor(61*Math.random())+30,2===t[o]&&(e[o]=Math.round(1.5*e[o]))}else e[o]=0})),e},getDemoExerciseTypesData(){return{"Strength Training":42,Cardio:35,Flexibility:15,HIIT:8}},getDemoMuscleGroupsData(){return{Chest:22,Back:25,Legs:30,Arms:18,Shoulders:15,Core:20}},renderFrequencyChart(e){if(!Ge)return void console.log("Skipping frequency chart render - component unmounted");if(this.frequencyChart)try{this.frequencyChart.destroy(),this.frequencyChart=null}catch(r){console.warn("Error destroying frequency chart:",r)}let t,o;Array.isArray(e.dates)&&Array.isArray(e.counts)?(t=e.dates,o=e.counts):(t=Object.keys(e),o=Object.values(e));const s=t.slice(-14),a=o.slice(-14);if(this.$refs.frequencyChart)try{const t=this.$refs.frequencyChart;if(!t)return void console.warn("Frequency chart canvas not found");if(0===t.offsetWidth||0===t.offsetHeight)return console.warn("Frequency chart canvas has zero dimensions, deferring render"),void(Ge&&setTimeout((()=>this.renderFrequencyChart(e)),250));const o=t.getContext("2d");if(!o)return void console.warn("Cannot get 2D context for frequency chart");this.frequencyChart=new Me.Ay(o,{type:"bar",data:{labels:s.map((e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}))),datasets:[{label:"Workouts",data:a,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}}),this.chartInstances.push(this.frequencyChart)}catch(r){console.error("Error rendering frequency chart:",r)}else console.warn("Cannot render frequency chart: Canvas element not found")},renderDurationChart(e){if(!Ge)return void console.log("Skipping duration chart render - component unmounted");if(this.durationChart)try{this.durationChart.destroy(),this.durationChart=null}catch(r){console.warn("Error destroying duration chart:",r)}let t,o;Array.isArray(e.dates)&&Array.isArray(e.durations)?(t=e.dates,o=e.durations):(t=Object.keys(e),o=Object.values(e));const s=t.slice(-14),a=o.slice(-14);if(this.$refs.durationChart)try{const t=this.$refs.durationChart;if(!t)return void console.warn("Duration chart canvas not found");if(0===t.offsetWidth||0===t.offsetHeight)return console.warn("Duration chart canvas has zero dimensions, deferring render"),void(Ge&&setTimeout((()=>this.renderDurationChart(e)),250));const o=t.getContext("2d");if(!o)return void console.warn("Cannot get 2D context for duration chart");this.durationChart=new Me.Ay(o,{type:"line",data:{labels:s.map((e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}))),datasets:[{label:"Duration (minutes)",data:a,backgroundColor:"rgba(46, 204, 113, 0.2)",borderColor:"rgba(46, 204, 113, 1)",borderWidth:2,tension:.2,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Minutes"}}}}}),this.chartInstances.push(this.durationChart)}catch(r){console.error("Error rendering duration chart:",r)}else console.warn("Cannot render duration chart: Canvas element not found")},renderExerciseTypesChart(e){if(!Ge)return void console.log("Skipping exercise types chart render - component unmounted");if(this.exerciseTypesChart)try{this.exerciseTypesChart.destroy(),this.exerciseTypesChart=null}catch(s){console.warn("Error destroying exercise types chart:",s)}let t,o;if(Array.isArray(e.labels)&&Array.isArray(e.data)?(t=e.labels,o=e.data):(t=Object.keys(e),o=Object.values(e)),this.$refs.exerciseTypesChart)try{const s=this.$refs.exerciseTypesChart;if(!s)return void console.warn("Exercise types chart canvas not found");if(0===s.offsetWidth||0===s.offsetHeight)return console.warn("Exercise types chart canvas has zero dimensions, deferring render"),void(Ge&&setTimeout((()=>this.renderExerciseTypesChart(e)),250));const a=s.getContext("2d");if(!a)return void console.warn("Cannot get 2D context for exercise types chart");const r=["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)"];this.exerciseTypesChart=new Me.Ay(a,{type:"pie",data:{labels:t,datasets:[{data:o,backgroundColor:r.slice(0,t.length),borderColor:"rgba(255, 255, 255, 0.5)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{boxWidth:15,padding:15}},tooltip:{enabled:!0}}}}),this.chartInstances.push(this.exerciseTypesChart)}catch(s){console.error("Error rendering exercise types chart:",s)}else console.warn("Cannot render exercise types chart: Canvas element not found")},renderMuscleGroupsChart(e){if(!Ge)return void console.log("Skipping muscle groups chart render - component unmounted");if(this.muscleGroupsChart)try{this.muscleGroupsChart.destroy(),this.muscleGroupsChart=null}catch(s){console.warn("Error destroying muscle groups chart:",s)}let t,o;if(Array.isArray(e.labels)&&Array.isArray(e.data)?(t=e.labels,o=e.data):(t=Object.keys(e),o=Object.values(e)),this.$refs.muscleGroupsChart)try{const s=this.$refs.muscleGroupsChart;if(!s)return void console.warn("Muscle groups chart canvas not found");if(0===s.offsetWidth||0===s.offsetHeight)return console.warn("Muscle groups chart canvas has zero dimensions, deferring render"),void(Ge&&setTimeout((()=>this.renderMuscleGroupsChart(e)),250));const a=s.getContext("2d");if(!a)return void console.warn("Cannot get 2D context for muscle groups chart");this.muscleGroupsChart=new Me.Ay(a,{type:"radar",data:{labels:t,datasets:[{label:"Focus Areas",data:o,backgroundColor:"rgba(142, 68, 173, 0.3)",borderColor:"rgba(142, 68, 173, 1)",borderWidth:2,pointBackgroundColor:"rgba(142, 68, 173, 1)",pointRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{r:{beginAtZero:!0,ticks:{display:!1}}}}}),this.chartInstances.push(this.muscleGroupsChart)}catch(s){console.error("Error rendering muscle groups chart:",s)}else console.warn("Cannot render muscle groups chart: Canvas element not found")},cleanupCharts(){console.log("Cleaning up all charts"),this.chartInstances.forEach((e=>{if(e)try{e.destroy()}catch(t){console.warn("Error destroying chart:",t)}})),this.chartInstances=[],this.frequencyChart=null,this.durationChart=null,this.exerciseTypesChart=null,this.muscleGroupsChart=null},handleResize(){Ge&&(this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((()=>{Ge&&this.refreshCharts()}),250))},refreshCharts(){if(!Ge)return;const e={frequency:this.frequencyChart?.data,duration:this.durationChart?.data,exerciseTypes:this.exerciseTypesChart?.data,muscleGroups:this.muscleGroupsChart?.data};this.cleanupCharts(),e.frequency&&this.renderFrequencyChart({dates:e.frequency.labels,counts:e.frequency.datasets[0].data}),e.duration&&this.renderDurationChart({dates:e.duration.labels,durations:e.duration.datasets[0].data}),e.exerciseTypes&&this.renderExerciseTypesChart({labels:e.exerciseTypes.labels,data:e.exerciseTypes.datasets[0].data}),e.muscleGroups&&this.renderMuscleGroupsChart({labels:e.muscleGroups.labels,data:e.muscleGroups.datasets[0].data})}},created(){console.log("Dashboard component created")},beforeMount(){Ge=!1,this.cleanupCharts()},mounted(){Ge=!0,console.log("Dashboard component mounted, current auth state:",{isAuthenticated:E.isAuthenticated(),hasToken:!!localStorage.getItem("auth_token"),hasUser:!!this.$store.state.user}),!this.$store.state.user&&E.isAuthenticated()?(console.log("User data missing but authenticated, loading user data first"),this.$store.dispatch("fetchUser").then((()=>{Ge&&(console.log("User data loaded successfully, now fetching dashboard data"),this.fetchData())})).catch((e=>{Ge&&(console.error("Failed to load user data in dashboard:",e),this.loading=!1,this.renderFrequencyChart(this.getDemoFrequencyData()),this.renderDurationChart(this.getDemoDurationData()),this.renderExerciseTypesChart(this.getDemoExerciseTypesData()),this.renderMuscleGroupsChart(this.getDemoMuscleGroupsData()))}))):this.fetchData(),this.$nextTick((()=>{Ge&&setTimeout((()=>{Ge&&!this.frequencyChart&&this.$refs.frequencyChart&&(console.log("Rendering demo charts as fallback"),this.renderFrequencyChart(this.getDemoFrequencyData()),this.renderDurationChart(this.getDemoDurationData()),this.renderExerciseTypesChart(this.getDemoExerciseTypesData()),this.renderMuscleGroupsChart(this.getDemoMuscleGroupsData()))}),500)})),window.addEventListener("resize",this.handleResize)},beforeUnmount(){console.log("Dashboard component unmounting"),Ge=!1,window.removeEventListener("resize",this.handleResize),this.cleanupCharts()},deactivated(){console.log("Dashboard component deactivated"),Ge=!1,this.cleanupCharts()}},Re=(0,I.A)(Oe,[["render",Ne],["__scopeId","data-v-226828cc"]]),qe=Re,Xe={class:"workout-plans"},Je={key:0,class:"loading"},je={key:1},He={class:"actions"},Be={key:0,class:"no-data"},ze={key:1,class:"plans-grid"},Ke={class:"plan-header"},Ye={class:"plan-actions"},Qe=["onClick"],Ze=["onClick"],et=["onClick"],tt={class:"plan-description"},ot={class:"plan-stats"},st={class:"plan-stat"},at={class:"plan-stat"},rt={class:"plan-footer"},nt=["onClick"],it={class:"modal-container"},lt={class:"modal-header"},ct={class:"modal-body"},ut={class:"plan-detail-description"},dt={class:"exercises-section"},gt={class:"exercises-header"},ht={key:0,class:"no-exercises"},pt={key:1,class:"exercises-list"},mt={class:"exercise-header"},kt={class:"exercise-actions"},ft=["onClick"],yt=["onClick"],vt={class:"exercise-description"},wt={class:"exercise-details"},Lt={class:"detail-item"},bt={class:"detail-value"},Dt={class:"detail-item"},At={class:"detail-value"},Ct={key:0,class:"detail-item"},Et={class:"detail-value"},St={key:1,class:"detail-item"},Pt={class:"detail-value"},Tt={class:"modal-footer"},It={class:"modal-container"},xt={class:"modal-header"},Ft={class:"modal-body"},Ut={class:"form-group"},_t={class:"form-group"},Vt={class:"form-actions"},$t=["disabled"],Nt={key:0},Mt={key:1},Wt={class:"modal-container"},Gt={class:"modal-header"},Ot={class:"modal-body"},Rt={class:"form-group"},qt={class:"form-group"},Xt={class:"form-row"},Jt={class:"form-group half-width"},jt={class:"form-group half-width"},Ht={class:"form-row"},Bt={class:"form-group half-width"},zt={class:"form-group half-width"},Kt={class:"form-actions"},Yt=["disabled"],Qt={key:0},Zt={key:1};function eo(e,t,o,a,r,l){return(0,n.uX)(),(0,n.CE)("div",Xe,[t[56]||(t[56]=(0,n.Lk)("h1",{class:"page-title"},"Workout Plans",-1)),r.loading?((0,n.uX)(),(0,n.CE)("div",Je,t[24]||(t[24]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Loading your workout plans...",-1)]))):((0,n.uX)(),(0,n.CE)("div",je,[(0,n.Lk)("div",He,[(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>l.openCreateModal&&l.openCreateModal(...e))},t[25]||(t[25]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Create New Plan ")]))]),0===e.workoutPlans.length?((0,n.uX)(),(0,n.CE)("div",Be,[t[27]||(t[27]=(0,n.Lk)("p",null,"You haven't created any workout plans yet.",-1)),t[28]||(t[28]=(0,n.Lk)("p",null,"Create your first workout plan to get started.",-1)),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>l.openCreateModal&&l.openCreateModal(...e))},t[26]||(t[26]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Create Workout Plan ")]))])):((0,n.uX)(),(0,n.CE)("div",ze,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.workoutPlans,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"plan-card"},[(0,n.Lk)("div",Ke,[(0,n.Lk)("h2",null,(0,i.v_)(e.name),1),(0,n.Lk)("div",Ye,[(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.viewPlan(e)},t[29]||(t[29]=[(0,n.Lk)("i",{class:"fas fa-eye"},null,-1)]),8,Qe),(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.openEditModal(e)},t[30]||(t[30]=[(0,n.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,Ze),(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.confirmDeletePlan(e)},t[31]||(t[31]=[(0,n.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,et)])]),(0,n.Lk)("p",tt,(0,i.v_)(e.description||"No description provided"),1),(0,n.Lk)("div",ot,[(0,n.Lk)("div",st,[t[32]||(t[32]=(0,n.Lk)("i",{class:"fas fa-dumbbell"},null,-1)),(0,n.Lk)("span",null,(0,i.v_)(e.exercises?e.exercises.length:0)+" Exercises",1)]),(0,n.Lk)("div",at,[t[33]||(t[33]=(0,n.Lk)("i",{class:"fas fa-calendar"},null,-1)),(0,n.Lk)("span",null,"Created "+(0,i.v_)(l.formatDate(e.createdAt)),1)])]),(0,n.Lk)("div",rt,[(0,n.Lk)("button",{class:"btn btn-outline",onClick:t=>l.viewPlan(e)}," View Details ",8,nt)])])))),128))])),r.selectedPlan?((0,n.uX)(),(0,n.CE)("div",{key:2,class:"modal-overlay",onClick:t[7]||(t[7]=(0,s.D$)(((...e)=>l.closeDetails&&l.closeDetails(...e)),["self"]))},[(0,n.Lk)("div",it,[(0,n.Lk)("div",lt,[(0,n.Lk)("h2",null,(0,i.v_)(r.selectedPlan.name),1),(0,n.Lk)("button",{class:"btn-close",onClick:t[2]||(t[2]=(...e)=>l.closeDetails&&l.closeDetails(...e))},t[34]||(t[34]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",ct,[(0,n.Lk)("div",ut,[t[35]||(t[35]=(0,n.Lk)("h3",null,"Description",-1)),(0,n.Lk)("p",null,(0,i.v_)(r.selectedPlan.description||"No description provided"),1)]),(0,n.Lk)("div",dt,[(0,n.Lk)("div",gt,[t[37]||(t[37]=(0,n.Lk)("h3",null,"Exercises",-1)),(0,n.Lk)("button",{class:"btn btn-sm btn-primary",onClick:t[3]||(t[3]=(...e)=>l.openAddExerciseModal&&l.openAddExerciseModal(...e))},t[36]||(t[36]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Add Exercise ")]))]),r.selectedPlan.exercises&&0!==r.selectedPlan.exercises.length?((0,n.uX)(),(0,n.CE)("div",pt,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.selectedPlan.exercises,((e,o)=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"exercise-item"},[(0,n.Lk)("div",mt,[(0,n.Lk)("h4",null,(0,i.v_)(o+1)+". "+(0,i.v_)(e.name),1),(0,n.Lk)("div",kt,[(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.openEditExerciseModal(e)},t[40]||(t[40]=[(0,n.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,ft),(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.confirmDeleteExercise(e)},t[41]||(t[41]=[(0,n.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,yt)])]),(0,n.Lk)("p",vt,(0,i.v_)(e.description||"No description"),1),(0,n.Lk)("div",wt,[(0,n.Lk)("div",Lt,[t[42]||(t[42]=(0,n.Lk)("span",{class:"detail-label"},"Sets:",-1)),(0,n.Lk)("span",bt,(0,i.v_)(e.sets),1)]),(0,n.Lk)("div",Dt,[t[43]||(t[43]=(0,n.Lk)("span",{class:"detail-label"},"Reps:",-1)),(0,n.Lk)("span",At,(0,i.v_)(e.reps),1)]),e.weight?((0,n.uX)(),(0,n.CE)("div",Ct,[t[44]||(t[44]=(0,n.Lk)("span",{class:"detail-label"},"Weight:",-1)),(0,n.Lk)("span",Et,(0,i.v_)(e.weight)+" kg",1)])):(0,n.Q3)("",!0),e.duration?((0,n.uX)(),(0,n.CE)("div",St,[t[45]||(t[45]=(0,n.Lk)("span",{class:"detail-label"},"Duration:",-1)),(0,n.Lk)("span",Pt,(0,i.v_)(l.formatDuration(e.duration)),1)])):(0,n.Q3)("",!0)])])))),128))])):((0,n.uX)(),(0,n.CE)("div",ht,[t[39]||(t[39]=(0,n.Lk)("p",null,"No exercises in this plan yet.",-1)),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>l.openAddExerciseModal&&l.openAddExerciseModal(...e))},t[38]||(t[38]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Add First Exercise ")]))]))])]),(0,n.Lk)("div",Tt,[(0,n.Lk)("button",{class:"btn btn-outline",onClick:t[5]||(t[5]=(...e)=>l.closeDetails&&l.closeDetails(...e))},"Close"),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=e=>l.logWorkout(r.selectedPlan))},"Log Workout")])])])):(0,n.Q3)("",!0),r.showPlanModal?((0,n.uX)(),(0,n.CE)("div",{key:3,class:"modal-overlay",onClick:t[13]||(t[13]=(0,s.D$)(((...e)=>l.closePlanModal&&l.closePlanModal(...e)),["self"]))},[(0,n.Lk)("div",It,[(0,n.Lk)("div",xt,[(0,n.Lk)("h2",null,(0,i.v_)(r.isEditing?"Edit Workout Plan":"Create Workout Plan"),1),(0,n.Lk)("button",{class:"btn-close",onClick:t[8]||(t[8]=(...e)=>l.closePlanModal&&l.closePlanModal(...e))},t[46]||(t[46]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",Ft,[(0,n.Lk)("form",{onSubmit:t[12]||(t[12]=(0,s.D$)((e=>r.isEditing?l.updatePlan():l.createPlan()),["prevent"]))},[(0,n.Lk)("div",Ut,[t[47]||(t[47]=(0,n.Lk)("label",{for:"planName"},"Plan Name",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"planName","onUpdate:modelValue":t[9]||(t[9]=e=>r.planForm.name=e),class:"form-control",required:""},null,512),[[s.Jo,r.planForm.name]])]),(0,n.Lk)("div",_t,[t[48]||(t[48]=(0,n.Lk)("label",{for:"planDescription"},"Description",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"planDescription","onUpdate:modelValue":t[10]||(t[10]=e=>r.planForm.description=e),class:"form-control",rows:"3"},null,512),[[s.Jo,r.planForm.description]])]),(0,n.Lk)("div",Vt,[(0,n.Lk)("button",{type:"button",class:"btn btn-outline",onClick:t[11]||(t[11]=(...e)=>l.closePlanModal&&l.closePlanModal(...e))},"Cancel"),(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.isSubmitting},[r.isSubmitting?((0,n.uX)(),(0,n.CE)("span",Nt,"Saving...")):((0,n.uX)(),(0,n.CE)("span",Mt,(0,i.v_)(r.isEditing?"Update Plan":"Create Plan"),1))],8,$t)])],32)])])])):(0,n.Q3)("",!0),r.showExerciseModal?((0,n.uX)(),(0,n.CE)("div",{key:4,class:"modal-overlay",onClick:t[23]||(t[23]=(0,s.D$)(((...e)=>l.closeExerciseModal&&l.closeExerciseModal(...e)),["self"]))},[(0,n.Lk)("div",Wt,[(0,n.Lk)("div",Gt,[(0,n.Lk)("h2",null,(0,i.v_)(r.isEditingExercise?"Edit Exercise":"Add Exercise"),1),(0,n.Lk)("button",{class:"btn-close",onClick:t[14]||(t[14]=(...e)=>l.closeExerciseModal&&l.closeExerciseModal(...e))},t[49]||(t[49]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",Ot,[(0,n.Lk)("form",{onSubmit:t[22]||(t[22]=(0,s.D$)((e=>r.isEditingExercise?l.updateExercise():l.addExercise()),["prevent"]))},[(0,n.Lk)("div",Rt,[t[50]||(t[50]=(0,n.Lk)("label",{for:"exerciseName"},"Exercise Name",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"exerciseName","onUpdate:modelValue":t[15]||(t[15]=e=>r.exerciseForm.name=e),class:"form-control",required:""},null,512),[[s.Jo,r.exerciseForm.name]])]),(0,n.Lk)("div",qt,[t[51]||(t[51]=(0,n.Lk)("label",{for:"exerciseDescription"},"Description",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"exerciseDescription","onUpdate:modelValue":t[16]||(t[16]=e=>r.exerciseForm.description=e),class:"form-control",rows:"2"},null,512),[[s.Jo,r.exerciseForm.description]])]),(0,n.Lk)("div",Xt,[(0,n.Lk)("div",Jt,[t[52]||(t[52]=(0,n.Lk)("label",{for:"exerciseSets"},"Sets",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"exerciseSets","onUpdate:modelValue":t[17]||(t[17]=e=>r.exerciseForm.sets=e),class:"form-control",min:"1",required:""},null,512),[[s.Jo,r.exerciseForm.sets]])]),(0,n.Lk)("div",jt,[t[53]||(t[53]=(0,n.Lk)("label",{for:"exerciseReps"},"Reps",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"exerciseReps","onUpdate:modelValue":t[18]||(t[18]=e=>r.exerciseForm.reps=e),class:"form-control",min:"1",required:""},null,512),[[s.Jo,r.exerciseForm.reps]])])]),(0,n.Lk)("div",Ht,[(0,n.Lk)("div",Bt,[t[54]||(t[54]=(0,n.Lk)("label",{for:"exerciseWeight"},"Weight (kg)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"exerciseWeight","onUpdate:modelValue":t[19]||(t[19]=e=>r.exerciseForm.weight=e),class:"form-control",step:"0.5",min:"0"},null,512),[[s.Jo,r.exerciseForm.weight]])]),(0,n.Lk)("div",zt,[t[55]||(t[55]=(0,n.Lk)("label",{for:"exerciseDuration"},"Duration (minutes)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"exerciseDuration","onUpdate:modelValue":t[20]||(t[20]=e=>r.exerciseForm.durationMinutes=e),class:"form-control",min:"0"},null,512),[[s.Jo,r.exerciseForm.durationMinutes]])])]),(0,n.Lk)("div",Kt,[(0,n.Lk)("button",{type:"button",class:"btn btn-outline",onClick:t[21]||(t[21]=(...e)=>l.closeExerciseModal&&l.closeExerciseModal(...e))},"Cancel"),(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.isSubmitting},[r.isSubmitting?((0,n.uX)(),(0,n.CE)("span",Qt,"Saving...")):((0,n.uX)(),(0,n.CE)("span",Zt,(0,i.v_)(r.isEditingExercise?"Update Exercise":"Add Exercise"),1))],8,Yt)])],32)])])])):(0,n.Q3)("",!0)]))])}class to{constructor(){this.store=null}init(e){this.store=e}showSuccess(e,t=5e3){if(!this.store)throw new Error("NotificationService not initialized with a store");this.store.dispatch("showMessage",{message:e,type:"success",timeout:t})}showError(e,t=8e3){if(!this.store)throw new Error("NotificationService not initialized with a store");this.store.dispatch("showMessage",{message:e,type:"error",timeout:t})}showWarning(e,t=6e3){if(!this.store)throw new Error("NotificationService not initialized with a store");this.store.dispatch("showMessage",{message:e,type:"warning",timeout:t})}showInfo(e,t=4e3){if(!this.store)throw new Error("NotificationService not initialized with a store");this.store.dispatch("showMessage",{message:e,type:"info",timeout:t})}}const oo=new to,so=oo;var ao=o(335);const ro="/api",no=ao.A.create({baseURL:ro,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});no.interceptors.request.use((e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e})),console.log("API URL being used:",ro),b.logApi("API URL configured",{url:ro});const io=!0,lo=()=>{const e=new Date,t={};for(let o=0;o<30;o++){const s=new Date;s.setDate(e.getDate()-(29-o));const a=s.toISOString().split("T")[0],r=s.getDay();let n=0;n=[1,3,5].includes(r)?Math.random()>.2?1:0:[2,4].includes(r)?Math.random()>.5?1:0:Math.random()>.7?1:0,1===n&&Math.random()>.9&&(n=2),t[a]=n}return t},co=lo(),uo=e=>{const t=new Date,o={};for(let s=0;s<30;s++){const a=new Date;a.setDate(t.getDate()-(29-s));const r=a.toISOString().split("T")[0];if(r in e&&e[r]>0){const t=a.getDay();[1,5].includes(t)?o[r]=Math.floor(31*Math.random())+45:[3].includes(t)?o[r]=Math.floor(31*Math.random())+60:[2,4].includes(t)?o[r]=Math.floor(31*Math.random())+30:o[r]=Math.floor(61*Math.random())+30,2===e[r]&&(o[r]=Math.round(1.5*o[r]))}else o[r]=0}return o},go={Goals:[{Id:1,Name:"Lose Weight",Description:"Reduce body weight through diet and exercise",StartDate:"2023-01-01",TargetDate:"2023-12-31",StartingValue:80,CurrentValue:75,TargetValue:70,MetricType:"weight",Unit:"kg",IsCompleted:!1,User:"user"},{Id:2,Name:"Run Marathon",Description:"Complete a full marathon",StartDate:"2023-02-01",TargetDate:"2023-10-31",StartingValue:0,CurrentValue:15,TargetValue:42,MetricType:"distance",Unit:"km",IsCompleted:!1,User:"user"},{Id:3,Name:"Increase Bench Press",Description:"Improve strength by increasing bench press weight",StartDate:"2023-01-15",TargetDate:"2023-11-30",StartingValue:60,CurrentValue:80,TargetValue:100,MetricType:"strength",Unit:"kg",IsCompleted:!1,User:"user"}],WorkoutPlans:[{id:1,name:"Full Body Workout",description:"Works all major muscle groups",frequency:"Every other day",exercises:[]},{id:2,name:"Cardio Routine",description:"High intensity cardio training",frequency:"3 times per week",exercises:[]},{id:3,name:"Upper/Lower Split",description:"Focus on upper body one day, lower body next",frequency:"4 times per week",exercises:[]},{id:4,name:"Push/Pull/Legs",description:"Classic bodybuilding split",frequency:"6 times per week",exercises:[]}],WorkoutLogs:[{id:1,workoutDate:"2023-05-15",duration:60,notes:"Good progress today",exerciseLogs:[{id:1,name:"Bench Press",sets:3,reps:10,weight:80,weightUnit:"kg"},{id:2,name:"Squats",sets:4,reps:8,weight:100,weightUnit:"kg"},{id:3,name:"Pull-ups",sets:3,reps:8,weight:null,weightUnit:"kg"}],workoutPlanId:1,workoutPlan:{id:1,name:"Full Body Workout"}},{id:2,workoutDate:"2023-05-17",duration:45,notes:"Feeling tired",exerciseLogs:[{id:4,name:"Treadmill",sets:1,reps:1,weight:null,weightUnit:"kg",duration:30},{id:5,name:"Jump Rope",sets:3,reps:1,weight:null,weightUnit:"kg",duration:5}],workoutPlanId:2,workoutPlan:{id:2,name:"Cardio Routine"}}],"WorkoutLogs/post":{id:3,workoutDate:(new Date).toISOString().split("T")[0],duration:60,notes:"Mock workout log created by offline mode",exerciseLogs:[],workoutPlanId:1,workoutPlan:{id:1,name:"Full Body Workout"}},"Stats/summary":{totalWorkouts:25,workoutsLast7Days:3,totalWorkoutHours:35,activeGoals:3,favoriteExercises:["Bench Press","Squats","Deadlift"],weeklyProgress:15,streakDays:3},"Stats/workout-frequency":co,"Stats/workout-duration":uo(co),"Stats/exercise-types":{"Strength Training":42,Cardio:35,Flexibility:15,HIIT:8},"Stats/muscle-groups":{Chest:22,Back:25,Legs:30,Arms:18,Shoulders:15,Core:20},"Goals/post":{Id:4,Name:"New Goal",Description:"Goal created from mock data",StartDate:(new Date).toISOString(),TargetDate:new Date(Date.now()+7776e6).toISOString(),StartingValue:0,CurrentValue:0,TargetValue:50,MetricType:"weight",Unit:"kg",IsCompleted:!1,User:"user"}};class ho{async get(e){return this.request(e,"GET")}async post(e,t){return this.request(e,"POST",t)}async put(e,t){return this.request(e,"PUT",t)}async delete(e){return this.request(e,"DELETE")}async request(e,t,o=null){const s=`${ro}/${e}`,a=e.startsWith("Goals"),r=E.getToken(),n=E.isAuthenticated(),i=localStorage.getItem("expires_at"),l=(new Date).getTime(),c=i?JSON.parse(i):0,u=i?Math.floor((c-l)/1e3/60):0;if(console.log(`${t} request to ${e}:`,{url:s,method:t,tokenStatus:{hasToken:!!r,isAuthenticated:n,expiresIn:u+" minutes",tokenLength:r?r.length:0,audience:r?JSON.parse(atob(r.split(".")[1])).aud||"unknown":"no token"}}),a&&(console.log(`${t} request to Goals endpoint:`,{url:s,method:t,data:o?JSON.stringify(o).substring(0,200)+(JSON.stringify(o).length>200?"...":""):null,token:E.getToken()?"Present (first 20 chars: "+E.getToken().substring(0,20)+"...)":"Not present",isAuthenticated:E.isAuthenticated()}),("POST"===t||"PUT"===t)&&o)){if(console.log(`Complete Goal ${t} request data:`,JSON.stringify(o,null,2)),o.goal){console.warn("Legacy goal data format detected (wrapped in goal object). API now expects root-level properties.");const e=o.goal;o=e,console.log("Unwrapped goal data to be sent:",JSON.stringify(o,null,2))}if(a){if(!o.Name&&o.name&&(o.Name=o.name),!o.Description&&o.description&&(o.Description=o.description),!o.Unit&&o.unit&&(o.Unit=o.unit),o.User)"string"===typeof o.User&&(o.User={Auth0Id:o.User});else try{const e=localStorage.getItem("user_profile");if(e){const t=JSON.parse(e);o.User={Auth0Id:t.sub||t.email||"user"}}else o.User={Auth0Id:"user"}}catch(d){console.error("Error retrieving user profile:",d),o.User={Auth0Id:"user"}}console.log("Final goal data to be sent:",JSON.stringify(o,null,2))}}b.logApi(`${t} request to ${e}`,{fullUrl:s});try{const i={"Content-Type":"application/json",Accept:"application/json"};if(r){i["Authorization"]=`Bearer ${r}`,b.logApi("Using auth token for API request",{hasToken:!0,tokenStart:r.substring(0,15)+"...",tokenExpired:!n,timeRemaining:u+" minutes"});try{const e=r.split(".");if(3===e.length){const t=JSON.parse(atob(e[1]));console.log("Token payload:",{iss:t.iss,aud:t.aud,exp:new Date(1e3*t.exp).toLocaleString(),iat:new Date(1e3*t.iat).toLocaleString(),scopes:t.scope})}}catch(g){console.error("Error parsing token:",g)}}else b.logApi("User is not authenticated, making unauthenticated request");const l={method:t,headers:i,mode:"cors",credentials:"include"};o&&(l.body=JSON.stringify(o)),b.logApi(`Sending request to ${s}`,{headers:Object.keys(i),method:t,config:JSON.stringify(l)});const c=await fetch(s,l);if(b.logApi(`Response received from ${e}`,{status:c.status,statusText:c.statusText,ok:c.ok,headers:Object.fromEntries([...c.headers].map((([e,t])=>[e,t])))}),401===c.status)return b.logApi(`Unauthorized response (401) from ${e}`,{headers:Object.fromEntries([...c.headers])}),a&&(console.error("Authentication failed when accessing Goals API. Details:",{endpoint:e,method:t,hasToken:!!E.getToken(),tokenExpired:!E.isAuthenticated()}),E.getToken()&&!E.isAuthenticated())?(so.showError("Your session has expired. Please log in again."),{error:"token_expired",status:401,message:"Authentication token has expired"}):(io||so.showError("Authentication error: Your session appears to be invalid."),{error:"unauthorized",status:401,message:"Authentication failed"});if(400===c.status){const t=await this.handleErrorResponse(c);throw a&&console.error("Bad request when creating/updating goal:",{status:400,details:JSON.stringify(t),sentData:o?JSON.stringify(o):"No data"}),b.logApi(`Error response (400) from ${e}`,t),t}if(204===c.status)return b.logApi(`No content response (204) from ${e}`),!0;if(c.ok){const t=c.headers.get("content-type");if(b.logApi(`Successful response from ${e}`,{contentType:t}),t&&t.includes("application/json")){const t=await c.json();return b.logApi(`JSON data received from ${e}`),t}const o=await c.text();return b.logApi(`Text data received from ${e}`),o}const d=await this.handleErrorResponse(c);throw b.logApi(`Error response from ${e}`,d),d}catch(h){if(b.logApi(`API Error (${t} ${s})`,{message:h.message,stack:h.stack}),console.error(`API Error (${t} ${s}):`,h),io&&("Failed to fetch"===h.message||h.message.includes("ECONNREFUSED")||h.message.includes("Network Error"))){if("POST"===t||"PUT"===t){if("WorkoutLogs"===e&&"POST"===t&&go["WorkoutLogs/post"]){console.warn(`API is unreachable. Using mock data for ${e} POST`);const t=o?.workoutLog||o,s={...go["WorkoutLogs/post"],...t,id:"number"===typeof t.id?t.id:Math.floor(1e3*Math.random())+100};return so.showWarning(`Using offline mock data for ${e} (POST)`),s}if("Goals"===e&&"POST"===t&&go["Goals/post"]){console.warn(`API is unreachable. Using mock data for ${e} POST`);const t=o?.goal||o,s={...go["Goals/post"],...t,id:"number"===typeof t.id?t.id:Math.floor(1e3*Math.random())+100};return so.showWarning(`Using offline mock data for ${e} (POST)`),s}console.warn(`API is unreachable. Echoing input data for ${e} ${t}`);const s={..."object"===typeof o?o:{},id:o?.id||Math.floor(1e3*Math.random())+100,createdAt:(new Date).toISOString(),isMockData:!0};return so.showWarning(`Using offline echo mode for ${e} (${t})`),s}if(go[e])return console.warn(`API is unreachable. Using mock data for ${e}`),so.showWarning(`Using offline mock data for ${e}`),go[e];const s=e.split("/")[0];if(go[s])return console.warn(`API is unreachable. Using mock data for ${s}`),so.showWarning(`Using offline mock data for ${s}`),go[s];console.warn(`No mock data available for ${e}`),so.showWarning(`API is unreachable and no mock data is available for ${e}`)}throw h}}async handleErrorResponse(e){try{const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const t=await e.json();return{status:e.status,message:t.message||t.title||"An error occurred",details:t.errors||t.detail||null}}{const t=await e.text();return{status:e.status,message:t||`HTTP Error: ${e.status}`}}}catch(t){return{status:e.status,message:`HTTP Error: ${e.status}`}}}}const po=new ho,mo={name:"WorkoutPlans",data(){return{loading:!0,isSubmitting:!1,selectedPlan:null,showPlanModal:!1,isEditing:!1,planForm:{id:null,name:"",description:""},showExerciseModal:!1,isEditingExercise:!1,exerciseForm:{id:null,name:"",description:"",sets:3,reps:10,weight:null,durationMinutes:null}}},computed:{...(0,r.aH)(["workoutPlans"])},methods:{async fetchData(){this.loading=!0;try{await this.$store.dispatch("fetchWorkoutPlans")}catch(e){console.error("Error fetching workout plans:",e)}finally{this.loading=!1}},formatDate(e){if(!e)return"";const t=new Date(e),o=Math.floor((Date.now()-t.getTime())/864e5);return 0===o?"Today":1===o?"Yesterday":t.toLocaleDateString()},formatDuration(e){if(!e)return"";const t="string"===typeof e?e.match(/PT(?:(\d+)H)?(?:(\d+)M)?/):null;if(t){const e=t[1]?parseInt(t[1]):0,o=t[2]?parseInt(t[2]):0;return e>0?`${e}h ${o}m`:`${o} min`}return""},viewPlan(e){this.selectedPlan={...e}},closeDetails(){this.selectedPlan=null},openCreateModal(){this.isEditing=!1,this.planForm={id:null,name:"",description:""},this.showPlanModal=!0},openEditModal(e){this.isEditing=!0,this.planForm={id:e.id,name:e.name,description:e.description},this.showPlanModal=!0},closePlanModal(){this.showPlanModal=!1,this.planForm={id:null,name:"",description:""}},async createPlan(){this.isSubmitting=!0;try{await this.$store.dispatch("createWorkoutPlan",{Name:this.planForm.name,Description:this.planForm.description});this.closePlanModal(),this.$store.dispatch("showMessage",{message:"Workout plan created successfully!",type:"success"})}catch(e){console.error("Error creating workout plan:",e),this.$store.dispatch("showMessage",{message:"Failed to create workout plan. Please try again.",type:"error"})}finally{this.isSubmitting=!1}},async updatePlan(){this.isSubmitting=!0;try{await this.$store.dispatch("updateWorkoutPlan",{Id:this.planForm.id,Name:this.planForm.name,Description:this.planForm.description}),this.closePlanModal(),this.selectedPlan&&this.selectedPlan.id===this.planForm.id&&(this.selectedPlan.name=this.planForm.name,this.selectedPlan.description=this.planForm.description),this.$store.dispatch("showMessage",{message:"Workout plan updated successfully!",type:"success"})}catch(e){console.error("Error updating workout plan:",e),this.$store.dispatch("showMessage",{message:"Failed to update workout plan. Please try again.",type:"error"})}finally{this.isSubmitting=!1}},confirmDeletePlan(e){confirm(`Are you sure you want to delete the workout plan "${e.name}"? This action cannot be undone.`)&&this.deletePlan(e.id)},async deletePlan(e){try{await this.$store.dispatch("deleteWorkoutPlan",e),this.selectedPlan&&this.selectedPlan.id===e&&(this.selectedPlan=null),this.$store.dispatch("showMessage",{message:"Workout plan deleted successfully!",type:"success"})}catch(t){console.error("Error deleting workout plan:",t),this.$store.dispatch("showMessage",{message:"Failed to delete workout plan. Please try again.",type:"error"})}},openAddExerciseModal(){this.isEditingExercise=!1,this.exerciseForm={id:null,name:"",description:"",sets:3,reps:10,weight:null,durationMinutes:null},this.showExerciseModal=!0},openEditExerciseModal(e){this.isEditingExercise=!0;let t=null;if(e.duration){const o=e.duration.match(/PT(?:(\d+)H)?(?:(\d+)M)?/);if(o){const e=o[1]?parseInt(o[1]):0,s=o[2]?parseInt(o[2]):0;t=60*e+s}}this.exerciseForm={id:e.id,name:e.name,description:e.description,sets:e.sets,reps:e.reps,weight:e.weight,durationMinutes:t},this.showExerciseModal=!0},closeExerciseModal(){this.showExerciseModal=!1},async addExercise(){this.isSubmitting=!0;try{let e=null;if(this.exerciseForm.durationMinutes){const t=Math.floor(this.exerciseForm.durationMinutes/60),o=this.exerciseForm.durationMinutes%60;e="PT",t>0&&(e+=`${t}H`),o>0&&(e+=`${o}M`),"PT"===e&&(e=null)}const t={Name:this.exerciseForm.name,Description:this.exerciseForm.description,WorkoutPlanId:this.selectedPlan.id,Sets:this.exerciseForm.sets,Reps:this.exerciseForm.reps,Weight:this.exerciseForm.weight,Duration:e};await po.post("Exercises",t);await this.fetchData();const o=this.workoutPlans.find((e=>e.id===this.selectedPlan.id));o&&(this.selectedPlan={...o}),this.closeExerciseModal(),this.$store.dispatch("showMessage",{message:"Exercise added successfully!",type:"success"})}catch(e){console.error("Error adding exercise:",e),this.$store.dispatch("showMessage",{message:"Failed to add exercise. Please try again.",type:"error"})}finally{this.isSubmitting=!1}},async updateExercise(){this.isSubmitting=!0;try{let e=null;if(this.exerciseForm.durationMinutes){const t=Math.floor(this.exerciseForm.durationMinutes/60),o=this.exerciseForm.durationMinutes%60;e="PT",t>0&&(e+=`${t}H`),o>0&&(e+=`${o}M`),"PT"===e&&(e=null)}const t={Id:this.exerciseForm.id,Name:this.exerciseForm.name,Description:this.exerciseForm.description,WorkoutPlanId:this.selectedPlan.id,Sets:this.exerciseForm.sets,Reps:this.exerciseForm.reps,Weight:this.exerciseForm.weight,Duration:e};await po.put(`Exercises/${this.exerciseForm.id}`,t),await this.fetchData();const o=this.workoutPlans.find((e=>e.id===this.selectedPlan.id));o&&(this.selectedPlan={...o}),this.closeExerciseModal(),this.$store.dispatch("showMessage",{message:"Exercise updated successfully!",type:"success"})}catch(e){console.error("Error updating exercise:",e),this.$store.dispatch("showMessage",{message:"Failed to update exercise. Please try again.",type:"error"})}finally{this.isSubmitting=!1}},confirmDeleteExercise(e){confirm(`Are you sure you want to delete the exercise "${e.name}"? This action cannot be undone.`)&&this.deleteExercise(e.id)},async deleteExercise(e){try{await po.delete(`Exercises/${e}`),await this.fetchData();const t=this.workoutPlans.find((e=>e.id===this.selectedPlan.id));t&&(this.selectedPlan={...t}),this.$store.dispatch("showMessage",{message:"Exercise deleted successfully!",type:"success"})}catch(t){console.error("Error deleting exercise:",t),this.$store.dispatch("showMessage",{message:"Failed to delete exercise. Please try again.",type:"error"})}},logWorkout(e){this.$router.push({path:"/workout-logs",query:{plan:e.id}})}},mounted(){this.fetchData()}},ko=(0,I.A)(mo,[["render",eo],["__scopeId","data-v-32d78e3c"]]),fo=ko,yo={class:"workout-logs"},vo={class:"workout-logs-container"},wo={class:"logs-section"},Lo={class:"section-header"},bo={key:0,class:"loading-indicator"},Do={key:1,class:"empty-state"},Ao={class:"card"},Co={class:"card-body text-center"},Eo={key:2,class:"logs-list"},So={class:"card-header"},Po={class:"log-actions"},To=["onClick"],Io=["onClick"],xo={class:"card-body"},Fo={class:"log-details"},Uo={class:"log-stat"},_o={class:"exercises-list"},Vo={key:0},$o={class:"exercise-item"},No={class:"exercise-name"},Mo={class:"exercise-detail"},Wo={key:1},Go={key:0,class:"log-notes"},Oo={key:0,class:"log-form-overlay"},Ro={class:"log-form-container card"},qo={class:"card-header"},Xo={class:"card-body"},Jo={class:"form-group"},jo={class:"form-group"},Ho=["value"],Bo={class:"form-group"},zo={class:"form-group"},Ko={class:"exercises-form-section"},Yo={class:"form-row"},Qo={class:"form-group"},Zo=["for"],es=["id","onUpdate:modelValue"],ts={class:"form-group"},os=["for"],ss=["id","onUpdate:modelValue"],as={class:"form-group"},rs=["for"],ns=["id","onUpdate:modelValue"],is={class:"form-row"},ls={class:"form-group"},cs=["for"],us=["id","onUpdate:modelValue"],ds={class:"form-group"},gs=["for"],hs=["id","onUpdate:modelValue"],ps=["onClick"],ms={class:"form-group"},ks={class:"form-actions"},fs={type:"submit",class:"btn btn-primary"},ys={key:1,class:"confirmation-modal"},vs={class:"confirmation-content card"},ws={class:"card-body"},Ls={class:"confirmation-actions"};function bs(e,t,o,a,r,l){return(0,n.uX)(),(0,n.CE)("div",yo,[t[35]||(t[35]=(0,n.Lk)("h1",null,"Workout Logs",-1)),(0,n.Lk)("div",vo,[(0,n.Lk)("div",wo,[(0,n.Lk)("div",Lo,[t[14]||(t[14]=(0,n.Lk)("h2",null,"Your Workout History",-1)),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=e=>r.showLogForm=!0)},t[13]||(t[13]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Log New Workout ")]))]),r.loading?((0,n.uX)(),(0,n.CE)("div",bo,t[15]||(t[15]=[(0,n.Lk)("p",null,"Loading your workout logs...",-1)]))):0===e.workoutLogs.length?((0,n.uX)(),(0,n.CE)("div",Do,[(0,n.Lk)("div",Ao,[(0,n.Lk)("div",Co,[t[16]||(t[16]=(0,n.Lk)("i",{class:"fas fa-dumbbell fa-3x mb-3"},null,-1)),t[17]||(t[17]=(0,n.Lk)("h3",null,"No Workout Logs Yet",-1)),t[18]||(t[18]=(0,n.Lk)("p",null,"Start tracking your fitness journey by logging your first workout.",-1)),(0,n.Lk)("button",{class:"btn btn-primary mt-3",onClick:t[1]||(t[1]=e=>r.showLogForm=!0)}," Log Your First Workout ")])])])):((0,n.uX)(),(0,n.CE)("div",Eo,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.workoutLogs,((e,o)=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"log-card card"},[(0,n.Lk)("div",So,[(0,n.Lk)("h3",null,(0,i.v_)(l.formatDate(e.workoutDate)),1),(0,n.Lk)("div",Po,[(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.editLog(e)},t[19]||(t[19]=[(0,n.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,To),(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.confirmDeleteLog(e.id)},t[20]||(t[20]=[(0,n.Lk)("i",{class:"fas fa-trash-alt"},null,-1)]),8,Io)])]),(0,n.Lk)("div",xo,[(0,n.Lk)("h4",null,(0,i.v_)(e.workoutPlan?e.workoutPlan.name:"Custom Workout"),1),(0,n.Lk)("div",Fo,[(0,n.Lk)("div",Uo,[t[21]||(t[21]=(0,n.Lk)("i",{class:"fas fa-clock"},null,-1)),(0,n.Lk)("span",null,(0,i.v_)(l.formatDuration(e.duration)),1)])]),(0,n.Lk)("div",_o,[t[22]||(t[22]=(0,n.Lk)("h5",null,"Exercises",-1)),e.exerciseLogs&&e.exerciseLogs.length>0?((0,n.uX)(),(0,n.CE)("ul",Vo,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.exerciseLogs,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e.id},[(0,n.Lk)("div",$o,[(0,n.Lk)("span",No,(0,i.v_)(e.exerciseName),1),(0,n.Lk)("span",Mo,[(0,n.eW)((0,i.v_)(e.sets)+" sets × "+(0,i.v_)(e.reps)+" reps ",1),e.weight?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.eW)(" × "+(0,i.v_)(e.weight)+" kg ",1)],64)):(0,n.Q3)("",!0)])])])))),128))])):((0,n.uX)(),(0,n.CE)("p",Wo,"No exercises recorded for this workout."))]),e.notes?((0,n.uX)(),(0,n.CE)("div",Go,[t[23]||(t[23]=(0,n.Lk)("h5",null,"Notes",-1)),(0,n.Lk)("p",null,(0,i.v_)(e.notes),1)])):(0,n.Q3)("",!0)])])))),128))]))]),r.showLogForm?((0,n.uX)(),(0,n.CE)("div",Oo,[(0,n.Lk)("div",Ro,[(0,n.Lk)("div",qo,[(0,n.Lk)("h3",null,(0,i.v_)(r.isEditing?"Edit Workout Log":"Log New Workout"),1),(0,n.Lk)("button",{class:"btn-icon",onClick:t[2]||(t[2]=(...e)=>l.closeForm&&l.closeForm(...e))},t[24]||(t[24]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",Xo,[(0,n.Lk)("form",{onSubmit:t[10]||(t[10]=(0,s.D$)(((...e)=>l.saveWorkoutLog&&l.saveWorkoutLog(...e)),["prevent"]))},[(0,n.Lk)("div",Jo,[t[25]||(t[25]=(0,n.Lk)("label",{for:"workout-date"},"Date",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"workout-date",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>r.logForm.date=e),required:""},null,512),[[s.Jo,r.logForm.date]])]),(0,n.Lk)("div",jo,[t[27]||(t[27]=(0,n.Lk)("label",{for:"workout-plan"},"Workout Plan (Optional)",-1)),(0,n.bo)((0,n.Lk)("select",{id:"workout-plan",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>r.logForm.workoutPlanId=e)},[t[26]||(t[26]=(0,n.Lk)("option",{value:""},"Custom Workout",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.workoutPlans,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,Ho)))),128))],512),[[s.u1,r.logForm.workoutPlanId]])]),(0,n.Lk)("div",Bo,[t[28]||(t[28]=(0,n.Lk)("label",{for:"workout-duration"},"Duration (minutes)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"workout-duration",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>r.logForm.duration=e),min:"1",required:""},null,512),[[s.Jo,r.logForm.duration,void 0,{number:!0}]])]),(0,n.Lk)("div",zo,[t[29]||(t[29]=(0,n.Lk)("label",{for:"calories-burned"},"Calories Burned (estimated)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"calories-burned",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>r.logForm.caloriesBurned=e),min:"0"},null,512),[[s.Jo,r.logForm.caloriesBurned,void 0,{number:!0}]])]),(0,n.Lk)("div",Ko,[t[31]||(t[31]=(0,n.Lk)("h4",null,"Exercises",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.logForm.exercises,((e,o)=>((0,n.uX)(),(0,n.CE)("div",{key:o,class:"exercise-form-item"},[(0,n.Lk)("div",Yo,[(0,n.Lk)("div",Qo,[(0,n.Lk)("label",{for:`exercise-name-${o}`},"Exercise Name",8,Zo),(0,n.bo)((0,n.Lk)("input",{id:`exercise-name-${o}`,type:"text",class:"form-control","onUpdate:modelValue":t=>e.name=t,required:""},null,8,es),[[s.Jo,e.name]])]),(0,n.Lk)("div",ts,[(0,n.Lk)("label",{for:`exercise-sets-${o}`},"Sets",8,os),(0,n.bo)((0,n.Lk)("input",{id:`exercise-sets-${o}`,type:"number",class:"form-control","onUpdate:modelValue":t=>e.sets=t,min:"1",required:""},null,8,ss),[[s.Jo,e.sets,void 0,{number:!0}]])]),(0,n.Lk)("div",as,[(0,n.Lk)("label",{for:`exercise-reps-${o}`},"Reps",8,rs),(0,n.bo)((0,n.Lk)("input",{id:`exercise-reps-${o}`,type:"number",class:"form-control","onUpdate:modelValue":t=>e.reps=t,min:"1",required:""},null,8,ns),[[s.Jo,e.reps,void 0,{number:!0}]])])]),(0,n.Lk)("div",is,[(0,n.Lk)("div",ls,[(0,n.Lk)("label",{for:`exercise-weight-${o}`},"Weight (optional)",8,cs),(0,n.bo)((0,n.Lk)("input",{id:`exercise-weight-${o}`,type:"number",class:"form-control","onUpdate:modelValue":t=>e.weight=t,min:"0"},null,8,us),[[s.Jo,e.weight,void 0,{number:!0}]])]),(0,n.Lk)("div",ds,[(0,n.Lk)("label",{for:`exercise-weight-unit-${o}`},"Unit",8,gs),(0,n.bo)((0,n.Lk)("select",{id:`exercise-weight-unit-${o}`,class:"form-control","onUpdate:modelValue":t=>e.weightUnit=t},t[30]||(t[30]=[(0,n.Lk)("option",{value:"kg"},"kg",-1),(0,n.Lk)("option",{value:"lbs"},"lbs",-1)]),8,hs),[[s.u1,e.weightUnit]])]),(0,n.Lk)("button",{type:"button",class:"btn btn-danger remove-exercise-btn",onClick:e=>l.removeExercise(o)}," Remove ",8,ps)])])))),128)),(0,n.Lk)("button",{type:"button",class:"btn btn-secondary add-exercise-btn",onClick:t[7]||(t[7]=(...e)=>l.addExercise&&l.addExercise(...e))}," Add Exercise ")]),(0,n.Lk)("div",ms,[t[32]||(t[32]=(0,n.Lk)("label",{for:"workout-notes"},"Notes",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"workout-notes",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=e=>r.logForm.notes=e),rows:"3"},null,512),[[s.Jo,r.logForm.notes]])]),(0,n.Lk)("div",ks,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[9]||(t[9]=(...e)=>l.closeForm&&l.closeForm(...e))}," Cancel "),(0,n.Lk)("button",fs,(0,i.v_)(r.isEditing?"Update":"Save"),1)])],32)])])])):(0,n.Q3)("",!0),r.showDeleteConfirm?((0,n.uX)(),(0,n.CE)("div",ys,[(0,n.Lk)("div",vs,[t[34]||(t[34]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h3",null,"Delete Workout Log")],-1)),(0,n.Lk)("div",ws,[t[33]||(t[33]=(0,n.Lk)("p",null,"Are you sure you want to delete this workout log? This action cannot be undone.",-1)),(0,n.Lk)("div",Ls,[(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[11]||(t[11]=e=>r.showDeleteConfirm=!1)}," Cancel "),(0,n.Lk)("button",{class:"btn btn-danger",onClick:t[12]||(t[12]=(...e)=>l.deleteLog&&l.deleteLog(...e))}," Delete ")])])])])):(0,n.Q3)("",!0)])])}const Ds={name:"WorkoutLogs",data(){return{loading:!0,showLogForm:!1,isEditing:!1,showDeleteConfirm:!1,logToDeleteId:null,logForm:this.getEmptyLogForm()}},computed:{...(0,r.aH)(["workoutLogs","workoutPlans"])},methods:{...(0,r.i0)(["fetchWorkoutLogs","fetchWorkoutPlans","createWorkoutLog","updateWorkoutLog","deleteWorkoutLog"]),getEmptyLogForm(){return{id:null,date:(new Date).toISOString().substr(0,10),workoutPlanId:"",duration:45,caloriesBurned:0,notes:"",exercises:[this.getEmptyExercise()]}},getEmptyExercise(){return{name:"",sets:3,reps:10,weight:null,weightUnit:"kg"}},addExercise(){this.logForm.exercises.push(this.getEmptyExercise())},removeExercise(e){this.logForm.exercises.length>1?this.logForm.exercises.splice(e,1):so.showWarning("You need at least one exercise in your workout")},async loadData(){this.loading=!0;try{await Promise.all([this.fetchWorkoutLogs(),this.fetchWorkoutPlans()])}catch(e){console.error("Error loading data:",e),so.showError("Failed to load workout data")}finally{this.loading=!1}},editLog(e){this.isEditing=!0,this.logForm={id:e.id,date:new Date(e.workoutDate).toISOString().substr(0,10),workoutPlanId:e.workoutPlanId||"",duration:this.getDurationInMinutes(e.duration),notes:e.notes||"",exercises:(e.exerciseLogs||[]).map((e=>({name:e.exerciseName,sets:e.sets,reps:e.reps,weight:e.weight,weightUnit:"kg"})))},0===this.logForm.exercises.length&&(this.logForm.exercises=[this.getEmptyExercise()]),this.showLogForm=!0},closeForm(){this.showLogForm=!1,this.isEditing=!1,this.logForm=this.getEmptyLogForm()},async saveWorkoutLog(){try{console.log("Saving workout log with form data:",JSON.stringify(this.logForm));const e={...this.logForm};null!==e.id&&(e.id=parseInt(e.id,10)||null);const t=new Date(e.date),o={id:e.id,workoutDate:t.toISOString(),duration:this.formatDurationForApi(e.duration),notes:e.notes||"",workoutPlanId:e.workoutPlanId?parseInt(e.workoutPlanId,10):null,exerciseLogs:(e.exercises||[]).map((e=>({exerciseName:e.name,sets:parseInt(e.sets,10),reps:parseInt(e.reps,10),weight:e.weight?parseFloat(e.weight):null,notes:"",duration:null})))};console.log("Formatted log to send to API:",JSON.stringify(o)),this.isEditing?(await this.updateWorkoutLog(o),so.showSuccess("Workout log updated successfully")):(await this.createWorkoutLog(o),so.showSuccess("Workout logged successfully")),this.closeForm()}catch(e){console.error("Error saving workout log:",e),so.showError("Failed to save workout log: "+(e.response?.data?.message||e.message))}},formatDurationForApi(e){e&&!isNaN(e)||(e=30);const t=Math.floor(e/60),o=e%60,s=`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:00`;return console.log(`Formatting ${e} minutes as TimeSpan: ${s}`),s},confirmDeleteLog(e){this.logToDeleteId=e,this.showDeleteConfirm=!0},async deleteLog(){try{await this.deleteWorkoutLog(this.logToDeleteId),so.showSuccess("Workout log deleted"),this.showDeleteConfirm=!1,this.logToDeleteId=null}catch(e){console.error("Error deleting workout log:",e),so.showError("Failed to delete workout log")}},formatDate(e){const t={weekday:"long",year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},formatDuration(e){if(!e)return"0 minutes";if("string"===typeof e&&e.includes(":")){const t=e.split(":"),o=parseInt(t[0]),s=parseInt(t[1]);return o>0?`${o} hour${1!==o?"s":""} ${s} minute${1!==s?"s":""}`:`${s} minute${1!==s?"s":""}`}return`${e} minute${1!==e?"s":""}`},getDurationInMinutes(e){if(!e)return 30;if("string"===typeof e&&e.includes(":")){const t=e.split(":"),o=parseInt(t[0]),s=parseInt(t[1]);return 60*o+s}return"number"===typeof e?e:30}},created(){this.loadData()}},As=(0,I.A)(Ds,[["render",bs],["__scopeId","data-v-88b173fa"]]),Cs=As,Es={class:"goals"},Ss={key:0,class:"auth-error-container"},Ps={class:"auth-error card"},Ts={class:"card-body text-center"},Is={key:1,class:"goals-container"},xs={class:"section-header"},Fs={key:0,class:"loading-indicator"},Us={key:1,class:"empty-state"},_s={class:"card"},Vs={class:"card-body text-center"},$s={key:2,class:"goals-list"},Ns={class:"card-header"},Ms={class:"goal-actions"},Ws=["onClick"],Gs=["onClick"],Os={class:"card-body"},Rs={class:"goal-title"},qs={class:"goal-description"},Xs={class:"goal-dates"},Js={class:"goal-date"},js={class:"goal-date"},Hs={class:"goal-metrics"},Bs={class:"goal-metric"},zs={class:"metric-label"},Ks={class:"metric-progress"},Ys={class:"progress-bar"},Qs={class:"progress-text"},Zs={class:"goal-update"},ea=["onClick"],ta={key:2,class:"goal-form-overlay"},oa={class:"goal-form-container card"},sa={class:"card-header"},aa={class:"card-body"},ra={class:"form-group"},na={class:"form-group"},ia={class:"form-row"},la={class:"form-group"},ca={class:"form-group"},ua={class:"form-group"},da={class:"form-row"},ga={class:"form-group"},ha={class:"form-group"},pa={class:"form-group"},ma={class:"form-group"},ka={class:"form-actions"},fa={key:3,class:"goal-form-overlay"},ya={class:"goal-form-container card"},va={class:"card-header"},wa={class:"card-body"},La={class:"form-group"},ba={for:"goal-current-value-update"},Da={class:"form-text text-muted"},Aa={class:"form-group"},Ca={class:"form-group"},Ea={class:"form-actions"},Sa={key:4,class:"confirmation-modal"},Pa={class:"confirmation-content card"},Ta={class:"card-body"},Ia={class:"confirmation-actions"};function xa(e,t,o,a,r,l){return(0,n.uX)(),(0,n.CE)("div",Es,[t[56]||(t[56]=(0,n.Lk)("h1",null,"Fitness Goals",-1)),r.authError?((0,n.uX)(),(0,n.CE)("div",Ss,[(0,n.Lk)("div",Ps,[(0,n.Lk)("div",Ts,[t[25]||(t[25]=(0,n.Lk)("i",{class:"fas fa-lock fa-3x mb-3"},null,-1)),t[26]||(t[26]=(0,n.Lk)("h3",null,"Authentication Required",-1)),(0,n.Lk)("p",null,(0,i.v_)(r.authErrorMessage),1),(0,n.Lk)("button",{class:"btn btn-primary mt-3",onClick:t[0]||(t[0]=(...e)=>l.redirectToLogin&&l.redirectToLogin(...e))}," Log In ")])])])):((0,n.uX)(),(0,n.CE)("div",Is,[(0,n.Lk)("div",xs,[t[28]||(t[28]=(0,n.Lk)("h2",null,"Your Goals",-1)),(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=e=>r.showGoalForm=!0)},t[27]||(t[27]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Set New Goal ")]))]),r.loading?((0,n.uX)(),(0,n.CE)("div",Fs,t[29]||(t[29]=[(0,n.Lk)("p",null,"Loading your goals...",-1)]))):0===e.goals.length?((0,n.uX)(),(0,n.CE)("div",Us,[(0,n.Lk)("div",_s,[(0,n.Lk)("div",Vs,[t[30]||(t[30]=(0,n.Lk)("i",{class:"fas fa-bullseye fa-3x mb-3"},null,-1)),t[31]||(t[31]=(0,n.Lk)("h3",null,"No Goals Set Yet",-1)),t[32]||(t[32]=(0,n.Lk)("p",null,"Setting clear goals is key to staying motivated and tracking your progress.",-1)),(0,n.Lk)("button",{class:"btn btn-primary mt-3",onClick:t[2]||(t[2]=e=>r.showGoalForm=!0)}," Set Your First Goal ")])])])):((0,n.uX)(),(0,n.CE)("div",$s,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.goals,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"goal-card card"},[(0,n.Lk)("div",Ns,[(0,n.Lk)("div",{class:(0,i.C4)(["goal-status",l.getGoalStatusClass(e)])},(0,i.v_)(l.getGoalStatusText(e)),3),(0,n.Lk)("div",Ms,[(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.editGoal(e)},t[33]||(t[33]=[(0,n.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,Ws),(0,n.Lk)("button",{class:"btn-icon",onClick:t=>l.confirmDeleteGoal(e.id)},t[34]||(t[34]=[(0,n.Lk)("i",{class:"fas fa-trash-alt"},null,-1)]),8,Gs)])]),(0,n.Lk)("div",Os,[(0,n.Lk)("h3",Rs,(0,i.v_)(e.name),1),(0,n.Lk)("p",qs,(0,i.v_)(e.description),1),(0,n.Lk)("div",Xs,[(0,n.Lk)("div",Js,[t[35]||(t[35]=(0,n.Lk)("i",{class:"fas fa-hourglass-start"},null,-1)),(0,n.Lk)("span",null,"Start: "+(0,i.v_)(l.formatDate(e.startDate)),1)]),(0,n.Lk)("div",js,[t[36]||(t[36]=(0,n.Lk)("i",{class:"fas fa-hourglass-end"},null,-1)),(0,n.Lk)("span",null,"Target: "+(0,i.v_)(l.formatDate(e.targetDate)),1)])]),(0,n.Lk)("div",Hs,[(0,n.Lk)("div",Bs,[(0,n.Lk)("div",zs,(0,i.v_)(l.getMetricLabel(e.metricType)),1),(0,n.Lk)("div",Ks,[(0,n.Lk)("div",Ys,[(0,n.Lk)("div",{class:(0,i.C4)(["progress-fill",l.getProgressClass(e)]),style:(0,i.Tr)({width:l.getProgressPercentage(e)+"%"})},null,6)]),(0,n.Lk)("div",Qs,(0,i.v_)(e.currentValue)+" / "+(0,i.v_)(e.targetValue)+" "+(0,i.v_)(l.getMetricUnit(e.metricType)),1)])])]),(0,n.Lk)("div",Zs,[(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t=>l.showUpdateForm(e)}," Update Progress ",8,ea)])])])))),128))]))])),r.showGoalForm?((0,n.uX)(),(0,n.CE)("div",ta,[(0,n.Lk)("div",oa,[(0,n.Lk)("div",sa,[(0,n.Lk)("h3",null,(0,i.v_)(r.isEditing?"Edit Goal":"Set New Goal"),1),(0,n.Lk)("button",{class:"btn-icon",onClick:t[3]||(t[3]=(...e)=>l.closeForm&&l.closeForm(...e))},t[37]||(t[37]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",aa,[(0,n.Lk)("form",{onSubmit:t[16]||(t[16]=(0,s.D$)(((...e)=>l.saveGoal&&l.saveGoal(...e)),["prevent"]))},[(0,n.Lk)("div",ra,[t[38]||(t[38]=(0,n.Lk)("label",{for:"goal-name"},"Goal Name",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"goal-name",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>r.goalForm.name=e),required:""},null,512),[[s.Jo,r.goalForm.name]])]),(0,n.Lk)("div",na,[t[39]||(t[39]=(0,n.Lk)("label",{for:"goal-description"},"Description",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"goal-description",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>r.goalForm.description=e),rows:"3"},null,512),[[s.Jo,r.goalForm.description]])]),(0,n.Lk)("div",ia,[(0,n.Lk)("div",la,[t[40]||(t[40]=(0,n.Lk)("label",{for:"goal-start-date"},"Start Date",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"goal-start-date",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>r.goalForm.startDate=e),required:""},null,512),[[s.Jo,r.goalForm.startDate]])]),(0,n.Lk)("div",ca,[t[41]||(t[41]=(0,n.Lk)("label",{for:"goal-target-date"},"Target Date",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"goal-target-date",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=e=>r.goalForm.targetDate=e),required:""},null,512),[[s.Jo,r.goalForm.targetDate]])])]),(0,n.Lk)("div",ua,[t[43]||(t[43]=(0,n.Lk)("label",{for:"goal-metric-type"},"Metric Type",-1)),(0,n.bo)((0,n.Lk)("select",{id:"goal-metric-type",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=e=>r.goalForm.metricType=e),onChange:t[9]||(t[9]=(...e)=>l.updateUnitBasedOnMetricType&&l.updateUnitBasedOnMetricType(...e)),required:""},t[42]||(t[42]=[(0,n.Fv)('<option value="weight" data-v-75c761ee>Body Weight</option><option value="workout_frequency" data-v-75c761ee>Workout Frequency</option><option value="strength" data-v-75c761ee>Strength</option><option value="distance" data-v-75c761ee>Distance</option><option value="calories" data-v-75c761ee>Calories Burned</option>',5)]),544),[[s.u1,r.goalForm.metricType]])]),(0,n.Lk)("div",da,[(0,n.Lk)("div",ga,[t[44]||(t[44]=(0,n.Lk)("label",{for:"goal-starting-value"},"Starting Value",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"goal-starting-value",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=e=>r.goalForm.startingValue=e),min:"0",step:"0.1",required:""},null,512),[[s.Jo,r.goalForm.startingValue,void 0,{number:!0}]])]),(0,n.Lk)("div",ha,[t[45]||(t[45]=(0,n.Lk)("label",{for:"goal-current-value"},"Current Value",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"goal-current-value",class:"form-control","onUpdate:modelValue":t[11]||(t[11]=e=>r.goalForm.currentValue=e),min:"0",step:"0.1",required:""},null,512),[[s.Jo,r.goalForm.currentValue,void 0,{number:!0}]])]),(0,n.Lk)("div",pa,[t[46]||(t[46]=(0,n.Lk)("label",{for:"goal-target-value"},"Target Value",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"goal-target-value",class:"form-control","onUpdate:modelValue":t[12]||(t[12]=e=>r.goalForm.targetValue=e),min:"0",step:"0.1",required:""},null,512),[[s.Jo,r.goalForm.targetValue,void 0,{number:!0}]])])]),(0,n.Lk)("div",ma,[t[48]||(t[48]=(0,n.Lk)("label",{for:"goal-unit"},"Unit",-1)),(0,n.bo)((0,n.Lk)("select",{id:"goal-unit",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=e=>r.goalForm.unit=e)},t[47]||(t[47]=[(0,n.Fv)('<option value="kg" data-v-75c761ee>Kilograms (kg)</option><option value="lbs" data-v-75c761ee>Pounds (lbs)</option><option value="workouts" data-v-75c761ee>Workouts</option><option value="times" data-v-75c761ee>Times</option><option value="km" data-v-75c761ee>Kilometers (km)</option><option value="mi" data-v-75c761ee>Miles (mi)</option><option value="kcal" data-v-75c761ee>Calories (kcal)</option>',7)]),512),[[s.u1,r.goalForm.unit]])]),(0,n.Lk)("div",ka,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[14]||(t[14]=(...e)=>l.closeForm&&l.closeForm(...e))}," Cancel "),(0,n.Lk)("button",{type:"button",class:"btn btn-success",onClick:t[15]||(t[15]=(...e)=>l.finalDebugApproach&&l.finalDebugApproach(...e))}," Create Goal ")])],32)])])])):(0,n.Q3)("",!0),r.showProgressForm?((0,n.uX)(),(0,n.CE)("div",fa,[(0,n.Lk)("div",ya,[(0,n.Lk)("div",va,[t[50]||(t[50]=(0,n.Lk)("h3",null,"Update Goal Progress",-1)),(0,n.Lk)("button",{class:"btn-icon",onClick:t[17]||(t[17]=(...e)=>l.closeProgressForm&&l.closeProgressForm(...e))},t[49]||(t[49]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,n.Lk)("div",wa,[(0,n.Lk)("form",{onSubmit:t[22]||(t[22]=(0,s.D$)(((...e)=>l.updateProgress&&l.updateProgress(...e)),["prevent"]))},[(0,n.Lk)("div",La,[(0,n.Lk)("label",ba," Current "+(0,i.v_)(l.getMetricLabel(r.progressForm.metricType)),1),(0,n.bo)((0,n.Lk)("input",{id:"goal-current-value-update",type:"number",class:"form-control","onUpdate:modelValue":t[18]||(t[18]=e=>r.progressForm.currentValue=e),min:"0",step:"0.1",required:""},null,512),[[s.Jo,r.progressForm.currentValue,void 0,{number:!0}]]),(0,n.Lk)("small",Da," Previous value: "+(0,i.v_)(r.progressForm.previousValue)+" "+(0,i.v_)(l.getMetricUnit(r.progressForm.metricType)),1)]),(0,n.Lk)("div",Aa,[t[51]||(t[51]=(0,n.Lk)("label",{for:"progress-date"},"Date",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"progress-date",class:"form-control","onUpdate:modelValue":t[19]||(t[19]=e=>r.progressForm.date=e),required:""},null,512),[[s.Jo,r.progressForm.date]])]),(0,n.Lk)("div",Ca,[t[52]||(t[52]=(0,n.Lk)("label",{for:"progress-notes"},"Notes (optional)",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"progress-notes",class:"form-control","onUpdate:modelValue":t[20]||(t[20]=e=>r.progressForm.notes=e),rows:"3"},null,512),[[s.Jo,r.progressForm.notes]])]),(0,n.Lk)("div",Ea,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[21]||(t[21]=(...e)=>l.closeProgressForm&&l.closeProgressForm(...e))}," Cancel "),t[53]||(t[53]=(0,n.Lk)("button",{type:"submit",class:"btn btn-primary"}," Update Progress ",-1))])],32)])])])):(0,n.Q3)("",!0),r.showDeleteConfirm?((0,n.uX)(),(0,n.CE)("div",Sa,[(0,n.Lk)("div",Pa,[t[55]||(t[55]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h3",null,"Delete Goal")],-1)),(0,n.Lk)("div",Ta,[t[54]||(t[54]=(0,n.Lk)("p",null,"Are you sure you want to delete this goal? This action cannot be undone.",-1)),(0,n.Lk)("div",Ia,[(0,n.Lk)("button",{class:"btn btn-secondary",onClick:t[23]||(t[23]=e=>r.showDeleteConfirm=!1)}," Cancel "),(0,n.Lk)("button",{class:"btn btn-danger",onClick:t[24]||(t[24]=(...e)=>l.deleteGoal&&l.deleteGoal(...e))}," Delete ")])])])])):(0,n.Q3)("",!0)])}const Fa={name:"Goals",data(){return{loading:!0,showGoalForm:!1,showProgressForm:!1,isEditing:!1,showDeleteConfirm:!1,goalToDeleteId:null,goalForm:this.getEmptyGoalForm(),progressForm:{goalId:null,previousValue:0,currentValue:0,metricType:"",date:(new Date).toISOString().substr(0,10),notes:""},authError:!1,authErrorMessage:"You need to be logged in to view and manage your goals."}},computed:{...(0,r.aH)(["goals"])},methods:{...(0,r.i0)(["fetchGoals","createGoal","updateGoal","updateGoalProgress","deleteGoal"]),getEmptyGoalForm(){const e=new Date,t=new Date(e);return t.setMonth(e.getMonth()+3),{id:null,name:"",description:"Goal created from workout tracker",startDate:e.toISOString().substr(0,10),targetDate:t.toISOString().substr(0,10),metricType:"weight",startingValue:0,currentValue:0,targetValue:0,unit:"kg",isCompleted:!1}},async loadData(){this.loading=!0;try{const e=localStorage.getItem("auth_token");if(!e)return console.error("No authentication token found"),this.authError=!0,this.authErrorMessage="You need to log in to view your goals.",void(this.loading=!1);console.log("Dispatching fetchGoals action from store"),await this.$store.dispatch("fetchGoals"),console.log("Goals loaded from store:",this.goals)}catch(e){console.error("Error loading goals:",e),401===e.status||e.message?.includes("Unauthorized")||e.message?.includes("401")?(this.authError=!0,this.authErrorMessage="Your session has expired. Please log in again.",localStorage.removeItem("auth_token"),so.showError("Authentication required")):so.showError("Failed to load goals data")}finally{this.loading=!1}},editGoal(e){this.isEditing=!0,this.goalForm={id:e.id,name:e.name,description:e.description||"",startDate:new Date(e.startDate).toISOString().substr(0,10),targetDate:new Date(e.targetDate).toISOString().substr(0,10),metricType:e.metricType,startingValue:e.startingValue,currentValue:e.currentValue,targetValue:e.targetValue,unit:e.unit||this.getMetricUnit(e.metricType),isCompleted:e.isCompleted||!1},this.showGoalForm=!0},showUpdateForm(e){this.progressForm={goalId:e.id,previousValue:e.currentValue,currentValue:e.currentValue,metricType:e.metricType,date:(new Date).toISOString().substr(0,10),notes:""},this.showProgressForm=!0},closeForm(){this.showGoalForm=!1,this.isEditing=!1,this.goalForm=this.getEmptyGoalForm()},closeProgressForm(){this.showProgressForm=!1},async saveGoal(){try{if(this.goalForm.name=this.goalForm.name.trim(),this.goalForm.description&&(this.goalForm.description=this.goalForm.description.trim()),!this.goalForm.name)return void so.showError("Goal name is required");if(!this.goalForm.targetValue)return void so.showError("Target value is required");const t={Id:null!==this.goalForm.id?parseInt(this.goalForm.id,10):null,Name:this.goalForm.name,Description:this.goalForm.description||"Goal created via workout tracker",StartDate:this.formatDateForApi(this.goalForm.startDate),TargetDate:this.formatDateForApi(this.goalForm.targetDate),StartingValue:parseFloat(this.goalForm.startingValue)||0,CurrentValue:parseFloat(this.goalForm.currentValue)||0,TargetValue:parseFloat(this.goalForm.targetValue)||0,MetricType:this.goalForm.metricType,Unit:this.goalForm.unit,IsCompleted:this.goalForm.isCompleted||!1};try{const o=localStorage.getItem("user_profile");if(o){const e=JSON.parse(o);t.User={Auth0Id:e.sub||e.email}}else{const o=localStorage.getItem("auth_token");if(o)try{const e=o.split(".");if(3===e.length){const o=JSON.parse(atob(e[1]));t.User={Auth0Id:o.sub}}}catch(e){console.error("Error extracting user ID from token:",e)}}}catch(e){console.error("Error setting user ID:",e)}console.log((this.isEditing?"Updating":"Creating")+" goal with data:",t),this.isEditing?(await this.$store.dispatch("updateGoal",t),so.showSuccess("Goal updated successfully")):(await this.$store.dispatch("createGoal",t),so.showSuccess("Goal created successfully")),this.closeForm(),await this.$store.dispatch("fetchGoals")}catch(t){console.error("Error saving goal:",t),400===t.status?so.showError(`Validation error: ${t.message||"Please check all required fields"}`):401===t.status?(so.showError("Authentication error: Please log in again"),this.authError=!0):so.showError(`Error ${this.isEditing?"updating":"creating"} goal: ${t.message||t}`)}},formatDateForApi(e){return e?"string"===typeof e&&e.includes("T")?e:new Date(e).toISOString():(new Date).toISOString()},async updateProgress(){try{if(console.log("Updating goal progress with data:",this.progressForm),!this.progressForm.goalId)return void so.showError("No goal selected for progress update");if(null===this.progressForm.currentValue||void 0===this.progressForm.currentValue)return void so.showError("Please enter a current value");const e=await this.$store.dispatch("updateGoalProgress",this.progressForm);console.log("Progress update successful:",e),so.showSuccess("Goal progress updated successfully"),this.closeProgressForm(),await this.$store.dispatch("fetchGoals")}catch(e){console.error("Error updating goal progress:",e),404===e.status?so.showError("The goal could not be found. It may have been deleted."):401===e.status?so.showError("Authentication error. Please log in again."):400===e.status?so.showError(`Validation error: ${e.message||"Please check all required fields"}`):so.showError(`Failed to update goal progress: ${e.message||"Unknown error"}`)}},confirmDeleteGoal(e){this.goalToDeleteId=e,this.showDeleteConfirm=!0},async deleteGoal(){try{await this.deleteGoal(this.goalToDeleteId),so.showSuccess("Goal deleted"),this.showDeleteConfirm=!1,this.goalToDeleteId=null}catch(e){console.error("Error deleting goal:",e),so.showError("Failed to delete goal")}},formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},getMetricLabel(e){const t={weight:"Body Weight",workout_frequency:"Workouts",strength:"Strength",distance:"Distance",calories:"Calories Burned"};return t[e]||e},getMetricUnit(e){const t={weight:"kg",workout_frequency:"workouts",strength:"kg",distance:"km",calories:"kcal"};return t[e]||""},getGoalStatusClass(e){if(new Date(e.targetDate)<new Date)return e.currentValue>=e.targetValue?"status-completed":"status-expired";const t=this.calculateProgress(e);return t>=100?"status-completed":t>=75?"status-on-track":t>=50?"status-in-progress":"status-started"},getGoalStatusText(e){if(new Date(e.targetDate)<new Date)return e.currentValue>=e.targetValue?"Completed":"Expired";const t=this.calculateProgress(e);return t>=100?"Completed":t>=75?"On Track":t>=50?"In Progress":"Started"},calculateProgress(e){if("weight"===e.metricType&&e.targetValue<e.startingValue){if(e.currentValue<=e.targetValue)return 100;const t=e.startingValue-e.targetValue,o=e.startingValue-e.currentValue;return Math.min(100,Math.max(0,o/t*100))}if(e.currentValue>=e.targetValue)return 100;const t=e.targetValue-e.startingValue,o=e.currentValue-e.startingValue;return Math.min(100,Math.max(0,o/t*100))},getProgressPercentage(e){return this.calculateProgress(e)},getProgressClass(e){const t=this.calculateProgress(e);return t>=100?"progress-complete":t>=75?"progress-good":t>=50?"progress-medium":t>=25?"progress-started":"progress-initial"},updateUnitBasedOnMetricType(){const e={weight:"kg",workout_frequency:"workouts",strength:"kg",distance:"km",calories:"kcal"};this.goalForm.unit=e[this.goalForm.metricType]||"",console.log(`Metric type changed to ${this.goalForm.metricType}, unit set to ${this.goalForm.unit}`)},async enhancedDebug(){try{let o="user",s=null;try{s=localStorage.getItem("auth_token"),console.log("Auth token present:",!!s);const e=localStorage.getItem("user_profile");if(e){const t=JSON.parse(e);o=t.sub||t.email||"user",console.log("Using userId from profile:",o)}}catch(e){console.error("Error retrieving user authentication info:",e)}if(!s&&(console.warn("No authentication token found! Trying to retrieve from other sources..."),s=localStorage.getItem("id_token")||localStorage.getItem("access_token")||sessionStorage.getItem("auth_token")||sessionStorage.getItem("id_token"),!s))throw so.showError("Authentication required! Please login first."),new Error("No authentication token available. User must login first.");const a={Name:"Enhanced Debug Goal",Description:"Created via enhanced debug method",Unit:"kg",User:o,StartDate:"2023-01-01T00:00:00Z",TargetDate:"2023-12-31T00:00:00Z",StartingValue:0,CurrentValue:0,TargetValue:100,MetricType:"weight",IsCompleted:!1},r=[{goal:a},{goal:{...a,Id:null}},{goal:{...a}},{GOAL:{...a}},{...a},{goal:{goal:{...a}}},{goal:{name:"Enhanced Debug Goal",description:"Created via enhanced debug method",unit:"kg",user:o,startDate:"2023-01-01T00:00:00Z",targetDate:"2023-12-31T00:00:00Z",startingValue:0,currentValue:0,targetValue:100,metricType:"weight",isCompleted:!1}}],n=localStorage.getItem("auth_token"),i="/api",l=`${i}/Goals`,c=[];for(let d=0;d<r.length;d++){const o=r[d];console.log(`ENHANCED DEBUG: Trying payload format ${d+1}:`,JSON.stringify(o,null,2));const s={"Content-Type":"application/json",Accept:"application/json"};n&&(s["Authorization"]=`Bearer ${n}`);try{const t=await fetch(l,{method:"POST",headers:s,body:JSON.stringify(o),mode:"cors",credentials:"include"});let a;try{a=await t.json()}catch(e){a={error:"Could not parse JSON response"}}const r={format:d+1,status:t.status,success:t.ok,payload:o,response:a};if(c.push(r),console.log(`ENHANCED DEBUG: Format ${d+1} result:`,{status:t.status,success:t.ok,responseData:a}),t.ok)return console.log(`SUCCESS! Format ${d+1} worked:`,a),so.showSuccess(`Enhanced debug goal created with format ${d+1}!`),this.closeForm(),this.$store.dispatch("fetchGoals"),a}catch(t){console.error(`ERROR: Format ${d+1} threw exception:`,t),c.push({format:d+1,status:"Exception",success:!1,payload:o,error:t.message})}}console.log("ENHANCED DEBUG: Combined results from all formats:",c);let u={};return c.forEach((e=>{!e.success&&e.response&&e.response.errors&&Object.keys(e.response.errors).forEach((e=>{u[e]||(u[e]=0),u[e]++}))})),console.log("ENHANCED DEBUG: Error field patterns:",u),so.showError(`Enhanced Debug: All ${r.length} formats failed. See console for details.`),{success:!1,results:c}}catch(t){return console.error("ENHANCED DEBUG: Uncaught exception:",t),so.showError(`Enhanced Debug error: ${t.message}`),{success:!1,error:t.message}}},async finalDebugApproach(){try{let t=localStorage.getItem("auth_token")||localStorage.getItem("id_token")||localStorage.getItem("access_token")||sessionStorage.getItem("auth_token")||sessionStorage.getItem("id_token");if(console.log("Auth token found:",!!t),!t)return console.error("No authentication token found in any storage!"),so.showError("Authentication required! Please login first."),this.$router.push("/login"),{success:!1,error:"Not authenticated"};const o=this.createApiGoalObject();console.log("FINAL DEBUG: Sending goal payload directly (no wrapper):",JSON.stringify(o,null,2));const s="/api",a=`${s}/Goals`;t&&!t.startsWith("Bearer ")&&(t=`Bearer ${t}`);const r={"Content-Type":"application/json",Accept:"application/json",Authorization:t};console.log("Request headers:",{"Content-Type":r["Content-Type"],Accept:r["Accept"],Authorization:t.substring(0,20)+"..."});const n=await fetch(a,{method:"POST",headers:r,body:JSON.stringify(o),credentials:"include",mode:"cors"});console.log("FINAL DEBUG: Response status:",n.status),console.log("FINAL DEBUG: Response status text:",n.statusText);const i={};for(const[e,c]of n.headers.entries())i[e]=c;let l;console.log("FINAL DEBUG: Response headers:",i);try{l=await n.json()}catch(e){l={error:"Could not parse JSON response",message:e.message}}if(console.log("FINAL DEBUG: Response data:",l),n.ok)return so.showSuccess("Goal created successfully!"),this.closeForm(),this.$store.dispatch("fetchGoals"),{success:!0,result:l};if(401===n.status)return console.error("AUTHENTICATION ERROR (401): ",l),console.log("Auth token issues. First 30 chars:",t.substring(0,30)+"..."),localStorage.removeItem("auth_token"),so.showError("Your session has expired. Please login again."),setTimeout((()=>{this.$router.push("/login")}),2e3),{success:!1,error:"Authentication failed",status:401};if(400===n.status){let e="Validation error: ";return l.errors?Object.keys(l.errors).forEach((t=>{e+=`${t}: ${l.errors[t].join(", ")}; `})):e+=l.title||"Unknown validation error",console.error("Validation errors:",l.errors||l),so.showError(e),{success:!1,error:l,status:400}}return console.error("API error:",l),so.showError(`Failed to create goal: ${n.status} - ${l.title||"Unknown error"}`),{success:!1,error:l}}catch(t){return console.error("FINAL DEBUG: Exception:",t),so.showError(`Error: ${t.message}`),{success:!1,error:t.message}}},createApiGoalObject(){let e="";try{const t=localStorage.getItem("user_profile");if(t){const o=JSON.parse(t);e=o.sub||o.email||"defaultUser",console.log("Using userId from profile:",e)}}catch(s){console.error("Error retrieving user ID:",s)}const t=new Date(this.goalForm.startDate).toISOString(),o=new Date(this.goalForm.targetDate).toISOString();return{Name:this.goalForm.name||"New Goal",Description:this.goalForm.description||"Goal created from workout tracker",Unit:this.goalForm.unit||"kg",User:{Auth0Id:e},StartDate:t,TargetDate:o,StartingValue:this.goalForm.startingValue||0,CurrentValue:this.goalForm.currentValue||0,TargetValue:this.goalForm.targetValue||0,MetricType:this.goalForm.metricType||"weight",IsCompleted:this.goalForm.isCompleted||!1,...this.goalForm.id?{Id:this.goalForm.id}:{}}},async checkAuthentication(){try{const e=localStorage.getItem("auth_token")||localStorage.getItem("id_token")||localStorage.getItem("access_token")||sessionStorage.getItem("auth_token");if(!e)return console.error("No authentication token found in storage"),this.authError=!0,this.authErrorMessage="Authentication required. Please log in to continue.",!1;const t=localStorage.getItem("user_profile");return t?console.log("User authenticated with profile"):console.warn("Auth token found, but no user profile available"),!0}catch(e){return console.error("Error checking authentication:",e),this.authError=!0,this.authErrorMessage="An error occurred during authentication check.",!1}},redirectToLogin(){this.$router.push("/login")},async debugAuth(){so.showInfo("Running authentication diagnostics...");try{let t=localStorage.getItem("auth_token")||localStorage.getItem("id_token")||localStorage.getItem("access_token")||sessionStorage.getItem("auth_token")||sessionStorage.getItem("id_token");if(!t)return console.error("No auth token found in any storage location!"),void so.showError("Authentication error: No token found");console.log("Auth token found with length:",t.length);let o=null,s=!1;try{const e=t.split(".");if(3===e.length){s=!0;const t=e[1],a=atob(t.replace(/-/g,"+").replace(/_/g,"/"));if(o=JSON.parse(a),console.log("Token decoded successfully:",o),o.exp){const e=new Date(1e3*o.exp),t=new Date;e<t?(console.error("TOKEN IS EXPIRED! Expired at:",e),so.showError(`Auth token expired on ${e.toLocaleString()}`)):(console.log("Token is valid until:",e.toLocaleString()),so.showInfo(`Token valid until ${e.toLocaleString()}`))}o.aud&&console.log("Token audience:",o.aud)}else console.warn("Token does not appear to be a valid JWT (doesn't have 3 parts)")}catch(e){console.error("Failed to decode token:",e)}try{t.startsWith("Bearer ")||(t=`Bearer ${t}`);const o="/api";console.log("Making test call to /api/Users/me to verify user exists...");const s=await fetch(`${o}/Users/me`,{method:"GET",headers:{Authorization:t,Accept:"application/json"},credentials:"include"});let a;console.log("Users/me response status:",s.status);try{a=await s.json(),console.log("User data:",a),s.ok?so.showSuccess("User exists in the database!"):401===s.status&&so.showError("Authentication failed when checking user")}catch(e){console.error("Could not parse user response:",e)}console.log("Making test call to /api/Goals...");const r=await fetch(`${o}/Goals`,{method:"GET",headers:{Authorization:t,Accept:"application/json"},credentials:"include"});console.log("Goals API test response status:",r.status);const n={};for(const[e,t]of r.headers.entries())n[e]=t;console.log("Response headers:",n),401===r.status?(so.showError("Authentication failed (401) - See console for details"),console.error("Authentication failed with the Goals API."),s.ok&&(console.log("INTERESTING: User endpoint works but Goals fails - likely a permission issue"),so.showInfo("User exists but doesn't have permission for Goals"))):r.ok&&so.showSuccess("Goals API authentication successful!");try{const e=await r.json();console.log("API response data:",e)}catch(e){console.error("Could not parse API response:",e)}}catch(e){console.error("Error making test API call:",e),so.showError(`API test error: ${e.message}`)}if(o){console.log("AUTH DIAGNOSTICS SUMMARY:"),console.log("- Token is a valid JWT:",s),console.log("- User ID/Subject:",o.sub),console.log("- Issuer:",o.iss),console.log("- Audience:",o.aud),console.log("- Issued at:",new Date(1e3*o.iat).toLocaleString()),console.log("- Expires at:",new Date(1e3*o.exp).toLocaleString());const e="https://localhost:7250/api";Array.isArray(o.aud)?o.aud.includes(e)||console.warn(`Token audience might be incorrect. Expected ${e} in`,o.aud):o.aud!==e&&console.warn(`Token audience might be incorrect. Expected ${e}, got ${o.aud}`),o.scope||o.permissions||console.warn("Token doesn't contain scope or permissions")}console.log("Auth diagnostics completed. Check console for detailed results."),so.showInfo("Auth diagnostics completed. Check console.")}catch(t){console.error("Auth diagnostics error:",t),so.showError(`Auth diagnostics error: ${t.message}`)}},async fetchGoalsFromApi(){try{console.log("Fetching goals directly from API");const e=await po.get("Goals");console.log("Goals API response:",e);let t=[];if(Array.isArray(e))t=e.map((e=>({id:e.Id||e.id,name:e.Name||e.name,description:e.Description||e.description,startDate:e.StartDate||e.startDate,targetDate:e.TargetDate||e.targetDate,startingValue:e.StartingValue||e.startingValue,currentValue:e.CurrentValue||e.currentValue,targetValue:e.TargetValue||e.targetValue,metricType:e.MetricType||e.metricType,unit:e.Unit||e.unit,isCompleted:e.IsCompleted||e.isCompleted,user:e.User||e.user})));else if(e&&"object"===typeof e)if(console.warn("Response is not an array, but an object:",e),e.Id||e.id){const o=e;t=[{id:o.Id||o.id,name:o.Name||o.name,description:o.Description||o.description,startDate:o.StartDate||o.startDate,targetDate:o.TargetDate||o.targetDate,startingValue:o.StartingValue||o.startingValue,currentValue:o.CurrentValue||o.currentValue,targetValue:o.TargetValue||o.targetValue,metricType:o.MetricType||o.metricType,unit:o.Unit||o.unit,isCompleted:o.IsCompleted||o.isCompleted,user:o.User||o.user}]}else Array.isArray(e.value)&&(console.log("Processing OData response format"),t=e.value.map((e=>({id:e.Id||e.id,name:e.Name||e.name,description:e.Description||e.description,startDate:e.StartDate||e.startDate,targetDate:e.TargetDate||e.targetDate,startingValue:e.StartingValue||e.startingValue,currentValue:e.CurrentValue||e.currentValue,targetValue:e.TargetValue||e.targetValue,metricType:e.MetricType||e.metricType,unit:e.Unit||e.unit,isCompleted:e.IsCompleted||e.isCompleted,user:e.User||e.user}))));console.log("Processed goals:",t),this.$store.commit("setGoals",t)}catch(e){console.error("Error fetching goals directly from API:",e),so.showError("Failed to load goals. Please try again.")}}},created(){console.log("Goals component created - checking for authentication");const e=localStorage.getItem("auth_token");if(!e)return console.warn("No authentication token found in localStorage"),this.authError=!0,this.authErrorMessage="Please log in to view and manage your fitness goals.",void(this.loading=!1);this.checkAuthentication().then((e=>{e?(console.log("User is authenticated, loading goals data"),this.loadData()):(console.warn("Authentication check failed"),this.authError=!0,this.authErrorMessage="Your session is invalid or has expired. Please log in again.",this.loading=!1)})).catch((e=>{console.error("Authentication check error:",e),this.authError=!0,this.authErrorMessage="An error occurred while checking your authentication. Please try again.",so.showError("Authentication check failed"),this.loading=!1}))}},Ua=(0,I.A)(Fa,[["render",xa],["__scopeId","data-v-75c761ee"]]),_a=Ua,Va={class:"profile-container"},$a={key:0,class:"loading"},Na={key:1,class:"profile-content"},Ma={class:"profile-card"},Wa={class:"profile-header"},Ga={class:"profile-picture"},Oa=["src"],Ra={key:1,class:"profile-placeholder"},qa={class:"profile-info"},Xa={class:"profile-email"},Ja={class:"profile-member"},ja={class:"profile-stats"},Ha={class:"stat-item"},Ba={class:"stat-value"},za={class:"stat-item"},Ka={class:"stat-value"},Ya={class:"stat-item"},Qa={class:"stat-value"},Za={class:"tabs"},er={class:"tab-content"},tr={key:0,class:"personal-info"},or={class:"form-group"},sr={class:"form-group"},ar={class:"form-group"},rr={class:"form-group"},nr={class:"form-group"},ir={class:"form-group"},lr={class:"form-actions"},cr=["disabled"],ur={key:0},dr={key:1},gr={key:1,class:"fitness-profile"},hr={class:"form-row"},pr={class:"form-group half-width"},mr={class:"form-group half-width"},kr={class:"form-group"},fr={class:"form-group"},yr={class:"checkbox-group"},vr={class:"checkbox-item"},wr={class:"checkbox-item"},Lr={class:"checkbox-item"},br={class:"checkbox-item"},Dr={class:"checkbox-item"},Ar={class:"form-group"},Cr={class:"form-actions"},Er=["disabled"],Sr={key:0},Pr={key:1},Tr={key:2,class:"preferences"},Ir={class:"form-group"},xr={class:"checkbox-group days"},Fr=["id","onUpdate:modelValue"],Ur=["for"],_r={class:"form-row"},Vr={class:"form-group half-width"},$r={class:"form-group half-width"},Nr={class:"form-group"},Mr={class:"form-group"},Wr={class:"checkbox-group"},Gr={class:"checkbox-item"},Or={class:"checkbox-item"},Rr={class:"checkbox-item"},qr={class:"form-actions"},Xr=["disabled"],Jr={key:0},jr={key:1},Hr={class:"account-settings"},Br={class:"setting-actions"};function zr(e,t,o,a,r,l){return(0,n.uX)(),(0,n.CE)("div",Va,[t[62]||(t[62]=(0,n.Lk)("h1",{class:"page-title"},"My Profile",-1)),r.loading?((0,n.uX)(),(0,n.CE)("div",$a,t[29]||(t[29]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Loading your profile...",-1)]))):((0,n.uX)(),(0,n.CE)("div",Na,[(0,n.Lk)("div",Ma,[(0,n.Lk)("div",Wa,[(0,n.Lk)("div",Ga,[r.userProfile.pictureUrl?((0,n.uX)(),(0,n.CE)("img",{key:0,src:r.userProfile.pictureUrl,alt:"Profile picture"},null,8,Oa)):((0,n.uX)(),(0,n.CE)("div",Ra,t[30]||(t[30]=[(0,n.Lk)("i",{class:"fas fa-user"},null,-1)])))]),(0,n.Lk)("div",qa,[(0,n.Lk)("h2",null,(0,i.v_)(e.user.name),1),(0,n.Lk)("p",Xa,(0,i.v_)(e.user.email),1),(0,n.Lk)("p",Ja,"Member since "+(0,i.v_)(l.formatDate(e.user.createdAt)),1)])]),(0,n.Lk)("div",ja,[(0,n.Lk)("div",Ha,[(0,n.Lk)("div",Ba,(0,i.v_)(e.stats?.totalWorkouts||0),1),t[31]||(t[31]=(0,n.Lk)("div",{class:"stat-label"},"Workouts",-1))]),(0,n.Lk)("div",za,[(0,n.Lk)("div",Ka,(0,i.v_)(e.workoutPlans.length||0),1),t[32]||(t[32]=(0,n.Lk)("div",{class:"stat-label"},"Workout Plans",-1))]),(0,n.Lk)("div",Ya,[(0,n.Lk)("div",Qa,(0,i.v_)(e.goals.filter((e=>e.isCompleted)).length||0),1),t[33]||(t[33]=(0,n.Lk)("div",{class:"stat-label"},"Goals Achieved",-1))])])]),(0,n.Lk)("div",Za,[(0,n.Lk)("div",{class:(0,i.C4)(["tab",{active:"personal"===r.activeTab}]),onClick:t[0]||(t[0]=e=>r.activeTab="personal")}," Personal Information ",2),(0,n.Lk)("div",{class:(0,i.C4)(["tab",{active:"fitness"===r.activeTab}]),onClick:t[1]||(t[1]=e=>r.activeTab="fitness")}," Fitness Profile ",2),(0,n.Lk)("div",{class:(0,i.C4)(["tab",{active:"preferences"===r.activeTab}]),onClick:t[2]||(t[2]=e=>r.activeTab="preferences")}," Preferences ",2)]),(0,n.Lk)("div",er,["personal"===r.activeTab?((0,n.uX)(),(0,n.CE)("div",tr,[(0,n.Lk)("form",{onSubmit:t[9]||(t[9]=(0,s.D$)(((...e)=>l.updatePersonalInfo&&l.updatePersonalInfo(...e)),["prevent"]))},[(0,n.Lk)("div",or,[t[34]||(t[34]=(0,n.Lk)("label",{for:"firstName"},"First Name",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"firstName","onUpdate:modelValue":t[3]||(t[3]=e=>r.userProfile.firstName=e),class:"form-control"},null,512),[[s.Jo,r.userProfile.firstName]])]),(0,n.Lk)("div",sr,[t[35]||(t[35]=(0,n.Lk)("label",{for:"lastName"},"Last Name",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"lastName","onUpdate:modelValue":t[4]||(t[4]=e=>r.userProfile.lastName=e),class:"form-control"},null,512),[[s.Jo,r.userProfile.lastName]])]),(0,n.Lk)("div",ar,[t[36]||(t[36]=(0,n.Lk)("label",{for:"birthdate"},"Date of Birth",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"birthdate","onUpdate:modelValue":t[5]||(t[5]=e=>r.userProfile.birthdate=e),class:"form-control"},null,512),[[s.Jo,r.userProfile.birthdate]])]),(0,n.Lk)("div",rr,[t[38]||(t[38]=(0,n.Lk)("label",{for:"gender"},"Gender",-1)),(0,n.bo)((0,n.Lk)("select",{id:"gender","onUpdate:modelValue":t[6]||(t[6]=e=>r.userProfile.gender=e),class:"form-control"},t[37]||(t[37]=[(0,n.Lk)("option",{value:""},"Prefer not to say",-1),(0,n.Lk)("option",{value:"male"},"Male",-1),(0,n.Lk)("option",{value:"female"},"Female",-1),(0,n.Lk)("option",{value:"other"},"Other",-1)]),512),[[s.u1,r.userProfile.gender]])]),(0,n.Lk)("div",nr,[t[39]||(t[39]=(0,n.Lk)("label",{for:"phoneNumber"},"Phone Number",-1)),(0,n.bo)((0,n.Lk)("input",{type:"tel",id:"phoneNumber","onUpdate:modelValue":t[7]||(t[7]=e=>r.userProfile.phoneNumber=e),class:"form-control"},null,512),[[s.Jo,r.userProfile.phoneNumber]])]),(0,n.Lk)("div",ir,[t[40]||(t[40]=(0,n.Lk)("label",{for:"pictureUrl"},"Profile Picture URL",-1)),(0,n.bo)((0,n.Lk)("input",{type:"url",id:"pictureUrl","onUpdate:modelValue":t[8]||(t[8]=e=>r.userProfile.pictureUrl=e),class:"form-control",placeholder:"https://example.com/your-profile-picture.jpg"},null,512),[[s.Jo,r.userProfile.pictureUrl]])]),(0,n.Lk)("div",lr,[(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.updating},[r.updating?((0,n.uX)(),(0,n.CE)("span",ur,"Saving...")):((0,n.uX)(),(0,n.CE)("span",dr,"Save Changes"))],8,cr)])],32)])):(0,n.Q3)("",!0),"fitness"===r.activeTab?((0,n.uX)(),(0,n.CE)("div",gr,[(0,n.Lk)("form",{onSubmit:t[19]||(t[19]=(0,s.D$)(((...e)=>l.updateFitnessProfile&&l.updateFitnessProfile(...e)),["prevent"]))},[(0,n.Lk)("div",hr,[(0,n.Lk)("div",pr,[t[41]||(t[41]=(0,n.Lk)("label",{for:"height"},"Height (cm)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"height","onUpdate:modelValue":t[10]||(t[10]=e=>r.userProfile.height=e),class:"form-control",step:"0.1",min:"0"},null,512),[[s.Jo,r.userProfile.height]])]),(0,n.Lk)("div",mr,[t[42]||(t[42]=(0,n.Lk)("label",{for:"weight"},"Weight (kg)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"weight","onUpdate:modelValue":t[11]||(t[11]=e=>r.userProfile.weight=e),class:"form-control",step:"0.1",min:"0"},null,512),[[s.Jo,r.userProfile.weight]])])]),(0,n.Lk)("div",kr,[t[44]||(t[44]=(0,n.Lk)("label",{for:"fitnessLevel"},"Fitness Level",-1)),(0,n.bo)((0,n.Lk)("select",{id:"fitnessLevel","onUpdate:modelValue":t[12]||(t[12]=e=>r.userProfile.fitnessLevel=e),class:"form-control"},t[43]||(t[43]=[(0,n.Lk)("option",{value:"beginner"},"Beginner",-1),(0,n.Lk)("option",{value:"intermediate"},"Intermediate",-1),(0,n.Lk)("option",{value:"advanced"},"Advanced",-1),(0,n.Lk)("option",{value:"professional"},"Professional",-1)]),512),[[s.u1,r.userProfile.fitnessLevel]])]),(0,n.Lk)("div",fr,[t[50]||(t[50]=(0,n.Lk)("label",null,"Fitness Goals (select multiple)",-1)),(0,n.Lk)("div",yr,[(0,n.Lk)("div",vr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"goalWeightLoss","onUpdate:modelValue":t[13]||(t[13]=e=>r.userProfile.fitnessGoals.weightLoss=e)},null,512),[[s.lH,r.userProfile.fitnessGoals.weightLoss]]),t[45]||(t[45]=(0,n.Lk)("label",{for:"goalWeightLoss"},"Weight Loss",-1))]),(0,n.Lk)("div",wr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"goalMuscleGain","onUpdate:modelValue":t[14]||(t[14]=e=>r.userProfile.fitnessGoals.muscleGain=e)},null,512),[[s.lH,r.userProfile.fitnessGoals.muscleGain]]),t[46]||(t[46]=(0,n.Lk)("label",{for:"goalMuscleGain"},"Muscle Gain",-1))]),(0,n.Lk)("div",Lr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"goalEndurance","onUpdate:modelValue":t[15]||(t[15]=e=>r.userProfile.fitnessGoals.endurance=e)},null,512),[[s.lH,r.userProfile.fitnessGoals.endurance]]),t[47]||(t[47]=(0,n.Lk)("label",{for:"goalEndurance"},"Endurance",-1))]),(0,n.Lk)("div",br,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"goalFlexibility","onUpdate:modelValue":t[16]||(t[16]=e=>r.userProfile.fitnessGoals.flexibility=e)},null,512),[[s.lH,r.userProfile.fitnessGoals.flexibility]]),t[48]||(t[48]=(0,n.Lk)("label",{for:"goalFlexibility"},"Flexibility",-1))]),(0,n.Lk)("div",Dr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"goalStrength","onUpdate:modelValue":t[17]||(t[17]=e=>r.userProfile.fitnessGoals.strength=e)},null,512),[[s.lH,r.userProfile.fitnessGoals.strength]]),t[49]||(t[49]=(0,n.Lk)("label",{for:"goalStrength"},"Strength",-1))])])]),(0,n.Lk)("div",Ar,[t[51]||(t[51]=(0,n.Lk)("label",{for:"medicalConditions"},"Medical Conditions",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"medicalConditions","onUpdate:modelValue":t[18]||(t[18]=e=>r.userProfile.medicalConditions=e),class:"form-control",rows:"3",placeholder:"List any medical conditions or injuries that might affect your workouts (optional)"},null,512),[[s.Jo,r.userProfile.medicalConditions]])]),(0,n.Lk)("div",Cr,[(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.updating},[r.updating?((0,n.uX)(),(0,n.CE)("span",Sr,"Saving...")):((0,n.uX)(),(0,n.CE)("span",Pr,"Save Changes"))],8,Er)])],32)])):(0,n.Q3)("",!0),"preferences"===r.activeTab?((0,n.uX)(),(0,n.CE)("div",Tr,[(0,n.Lk)("form",{onSubmit:t[26]||(t[26]=(0,s.D$)(((...e)=>l.updatePreferences&&l.updatePreferences(...e)),["prevent"]))},[(0,n.Lk)("div",Ir,[t[52]||(t[52]=(0,n.Lk)("label",{for:"preferredWorkoutDays"},"Preferred Workout Days",-1)),(0,n.Lk)("div",xr,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.daysOfWeek,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"day-checkbox"},[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"day-"+t,"onUpdate:modelValue":e=>r.userProfile.preferences.workoutDays[t]=e},null,8,Fr),[[s.lH,r.userProfile.preferences.workoutDays[t]]]),(0,n.Lk)("label",{for:"day-"+t},(0,i.v_)(e),9,Ur)])))),128))])]),(0,n.Lk)("div",_r,[(0,n.Lk)("div",Vr,[t[53]||(t[53]=(0,n.Lk)("label",{for:"workoutStartTime"},"Preferred Workout Start Time",-1)),(0,n.bo)((0,n.Lk)("input",{type:"time",id:"workoutStartTime","onUpdate:modelValue":t[20]||(t[20]=e=>r.userProfile.preferences.workoutStartTime=e),class:"form-control"},null,512),[[s.Jo,r.userProfile.preferences.workoutStartTime]])]),(0,n.Lk)("div",$r,[t[54]||(t[54]=(0,n.Lk)("label",{for:"workoutDuration"},"Average Workout Duration (minutes)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number",id:"workoutDuration","onUpdate:modelValue":t[21]||(t[21]=e=>r.userProfile.preferences.workoutDuration=e),class:"form-control",min:"5",step:"5"},null,512),[[s.Jo,r.userProfile.preferences.workoutDuration]])])]),(0,n.Lk)("div",Nr,[t[56]||(t[56]=(0,n.Lk)("label",{for:"preferredWorkoutType"},"Preferred Workout Type",-1)),(0,n.bo)((0,n.Lk)("select",{id:"preferredWorkoutType","onUpdate:modelValue":t[22]||(t[22]=e=>r.userProfile.preferences.workoutType=e),class:"form-control"},t[55]||(t[55]=[(0,n.Fv)('<option value="strength" data-v-5c84cf21>Strength Training</option><option value="cardio" data-v-5c84cf21>Cardio</option><option value="hiit" data-v-5c84cf21>HIIT</option><option value="yoga" data-v-5c84cf21>Yoga</option><option value="mixed" data-v-5c84cf21>Mixed</option>',5)]),512),[[s.u1,r.userProfile.preferences.workoutType]])]),(0,n.Lk)("div",Mr,[t[60]||(t[60]=(0,n.Lk)("label",{for:"notifications"},"Notification Preferences",-1)),(0,n.Lk)("div",Wr,[(0,n.Lk)("div",Gr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"notifyReminders","onUpdate:modelValue":t[23]||(t[23]=e=>r.userProfile.preferences.notifications.reminders=e)},null,512),[[s.lH,r.userProfile.preferences.notifications.reminders]]),t[57]||(t[57]=(0,n.Lk)("label",{for:"notifyReminders"},"Workout Reminders",-1))]),(0,n.Lk)("div",Or,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"notifyProgress","onUpdate:modelValue":t[24]||(t[24]=e=>r.userProfile.preferences.notifications.progress=e)},null,512),[[s.lH,r.userProfile.preferences.notifications.progress]]),t[58]||(t[58]=(0,n.Lk)("label",{for:"notifyProgress"},"Progress Updates",-1))]),(0,n.Lk)("div",Rr,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"notifyTips","onUpdate:modelValue":t[25]||(t[25]=e=>r.userProfile.preferences.notifications.tips=e)},null,512),[[s.lH,r.userProfile.preferences.notifications.tips]]),t[59]||(t[59]=(0,n.Lk)("label",{for:"notifyTips"},"Workout Tips",-1))])])]),(0,n.Lk)("div",qr,[(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.updating},[r.updating?((0,n.uX)(),(0,n.CE)("span",Jr,"Saving...")):((0,n.uX)(),(0,n.CE)("span",jr,"Save Changes"))],8,Xr)])],32)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Hr,[t[61]||(t[61]=(0,n.Lk)("h2",null,"Account Settings",-1)),(0,n.Lk)("div",Br,[(0,n.Lk)("button",{class:"btn btn-outline",onClick:t[27]||(t[27]=(...e)=>l.resetPassword&&l.resetPassword(...e))}," Reset Password "),(0,n.Lk)("button",{class:"btn btn-danger",onClick:t[28]||(t[28]=(...e)=>l.confirmDeleteAccount&&l.confirmDeleteAccount(...e))}," Delete Account ")])])]))])}const Kr={name:"Profile",data(){return{loading:!0,updating:!1,activeTab:"personal",userProfile:{firstName:"",lastName:"",birthdate:"",gender:"",phoneNumber:"",pictureUrl:"",height:null,weight:null,fitnessLevel:"beginner",fitnessGoals:{weightLoss:!1,muscleGain:!1,endurance:!1,flexibility:!1,strength:!1},medicalConditions:"",preferences:{workoutDays:[!1,!1,!1,!1,!1,!1,!1],workoutStartTime:"18:00",workoutDuration:45,workoutType:"mixed",notifications:{reminders:!0,progress:!0,tips:!1}}},daysOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},computed:{...(0,r.aH)(["user","workoutPlans","goals","stats"])},methods:{formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},async fetchData(){this.loading=!0;try{await Promise.all([this.$store.dispatch("fetchUser"),this.$store.dispatch("fetchWorkoutPlans"),this.$store.dispatch("fetchGoals"),this.$store.dispatch("fetchStats")]);const e=await fetch("https://localhost:5001/api/Users/profile",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(e.ok){const t=await e.json();this.mergeProfileData(t)}}catch(e){console.error("Error fetching profile data:",e)}finally{this.loading=!1}},mergeProfileData(e){e&&(this.userProfile={...this.userProfile,...e,fitnessGoals:{...this.userProfile.fitnessGoals,...e.fitnessGoals||{}},preferences:{...this.userProfile.preferences,...e.preferences||{},notifications:{...this.userProfile.preferences.notifications,...e.preferences?.notifications||{}}}})},async updatePersonalInfo(){await this.saveProfile()},async updateFitnessProfile(){await this.saveProfile()},async updatePreferences(){await this.saveProfile()},async saveProfile(){this.updating=!0;try{const e=await fetch("https://localhost:5001/api/Users/profile",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json"},body:JSON.stringify(this.userProfile)});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to update profile")}this.$store.dispatch("showMessage",{message:"Profile updated successfully",type:"success"})}catch(e){this.$store.dispatch("showMessage",{message:e.message||"An error occurred while updating your profile",type:"error"})}finally{this.updating=!1}},resetPassword(){const e=new E;e.resetPassword(this.user.email).then((()=>{this.$store.dispatch("showMessage",{message:"Password reset email sent",type:"success"})})).catch((e=>{this.$store.dispatch("showMessage",{message:e.message||"Failed to send password reset email",type:"error"})}))},confirmDeleteAccount(){confirm("Are you sure you want to delete your account? This action cannot be undone.")&&this.deleteAccount()},async deleteAccount(){try{const e=await fetch("https://localhost:5001/api/Users",{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to delete account")}{const e=new E;await e.logout(),this.$router.push("/"),this.$store.dispatch("showMessage",{message:"Your account has been deleted successfully",type:"success"})}}catch(e){this.$store.dispatch("showMessage",{message:e.message||"An error occurred while deleting your account",type:"error"})}}},mounted(){this.fetchData()}},Yr=(0,I.A)(Kr,[["render",zr],["__scopeId","data-v-5c84cf21"]]),Qr=Yr,Zr={class:"container"},en={class:"spinner-container"},tn={key:0,class:"error-message"};function on(e,t,o,s,a,r){return(0,n.uX)(),(0,n.CE)("div",Zr,[(0,n.Lk)("div",en,[t[0]||(t[0]=(0,n.Lk)("div",{class:"spinner"},null,-1)),(0,n.Lk)("p",null,(0,i.v_)(s.statusMessage),1),s.authError?((0,n.uX)(),(0,n.CE)("div",tn,(0,i.v_)(s.authError),1)):(0,n.Q3)("",!0)])])}const sn={name:"Callback",setup(){const e=(0,a.rd)(),t=(0,r.Pj)(),o=(0,U.KR)(null),s=(0,U.KR)("Logging you in..."),i=(t,o=500)=>{console.log(`Will redirect to ${t} in ${o}ms`),s.value="Redirecting you to application...",setTimeout((()=>{e.push(t)}),o)};return(0,n.sV)((async()=>{if(b.logNavigation("Callback page mounted"),console.log("Callback component mounted, processing authentication result..."),s.value="Processing authentication...",!window.location.hash||window.location.hash.length<2)return console.error("No hash in URL - Auth0 did not send tokens"),o.value="Authentication failed: No tokens received from Auth0",s.value="Authentication failed!",void i("/login");if(window.location.hash.includes("error=")){console.error("Error parameter found in hash:",window.location.hash);const e=window.location.hash.match(/error=([^&]*)/),t=window.location.hash.match(/error_description=([^&]*)/),a=e?decodeURIComponent(e[1]):"unknown",r=t?decodeURIComponent(t[1]):"Unknown error";return o.value=`Auth0 Error: ${a} - ${r}`,s.value="Authentication failed!",b.logAuth("Authentication error found in hash",{errorCode:a,errorDesc:r}),void i("/login")}try{console.log("Calling AuthService.handleAuthentication()..."),s.value="Validating authentication...";const a=await E.handleAuthentication();if(console.log("Auth result:",a?"SUCCESS":"FAILED"),a){console.log("Authentication successful, getting user info..."),s.value="Getting user information...";try{const e=localStorage.getItem("auth_token"),o=localStorage.getItem("id_token");if(!e||!o)throw new Error("Authentication tokens not saved properly");console.log("Tokens saved successfully:",{hasAccessToken:!!e,hasIdToken:!!o});const a=await E.getUser();if(console.log("User info retrieved:",a?"User found":"No user data"),!a)throw new Error("No user data received");t.commit("setUser",a),console.log("User data saved in Vuex store:",a),t.commit("setAuthenticated",!0);const r=E.isAuthenticated();if(console.log("Final auth check before redirect:",r),!r)throw new Error("Authentication state verification failed");t.dispatch("showMessage",{message:"Login successful!",type:"success"}),console.log("Authentication complete, redirecting to dashboard..."),s.value="Login successful!",b.logAuth("Authentication completed successfully"),i("/dashboard")}catch(e){console.error("Error getting user info:",e),o.value="Login successful but failed to get user info. Please try again.",s.value="Failed to get user information",b.logAuth("Error getting user info",{error:e.message}),i("/login")}}else console.log("Authentication failed without error, redirecting to login..."),o.value="Authentication failed. Please try again.",s.value="Authentication failed!",b.logAuth("Authentication failed without specific error"),i("/login")}catch(a){console.error("Authentication error caught:",a),o.value=a.message||"Authentication error. Please try again.",s.value="Authentication failed!",b.logAuth("Authentication error",{error:a.message}),i("/login")}})),{authError:o,statusMessage:s}}},an=(0,I.A)(sn,[["render",on],["__scopeId","data-v-0be98280"]]),rn=an,nn={class:"debug-page"},ln={class:"card"},cn={class:"card-body"},un={class:"debug-info"},dn={class:"actions"},gn={key:0,class:"card mt-4"},hn={class:"card-body"},pn={class:"token-tabs"},mn={class:"token-content"},kn={key:0,class:"token-decoded"},fn={key:1,class:"token-raw"},yn={readonly:""},vn={class:"card mt-4"},wn={class:"card-body"},Ln={key:0,class:"no-tests"},bn={key:1,class:"test-results"},Dn={class:"result-header"},An={class:"result-title"},Cn={class:"result-status"},En={class:"result-details"},Sn={class:"card mt-4"},Pn={class:"card-body"},Tn={class:"debug-actions"};function In(e,t,o,s,a,r){return(0,n.uX)(),(0,n.CE)("div",nn,[t[19]||(t[19]=(0,n.Lk)("h1",null,"Authentication Diagnostics",-1)),(0,n.Lk)("div",ln,[t[13]||(t[13]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"Authentication Status")],-1)),(0,n.Lk)("div",cn,[(0,n.Lk)("div",{class:(0,i.C4)(["status-indicator",s.isAuthenticated?"status-success":"status-danger"])},[(0,n.Lk)("span",null,(0,i.v_)(s.isAuthenticated?"Authenticated":"Not Authenticated"),1)],2),(0,n.Lk)("div",un,[(0,n.Lk)("p",null,[t[9]||(t[9]=(0,n.Lk)("strong",null,"Has Auth Token:",-1)),(0,n.eW)(" "+(0,i.v_)(s.hasToken?"Yes":"No"),1)]),(0,n.Lk)("p",null,[t[10]||(t[10]=(0,n.Lk)("strong",null,"Token Expiry:",-1)),(0,n.eW)(" "+(0,i.v_)(s.tokenExpiry),1)]),(0,n.Lk)("p",null,[t[11]||(t[11]=(0,n.Lk)("strong",null,"Time Remaining:",-1)),(0,n.eW)(" "+(0,i.v_)(s.timeRemaining),1)]),(0,n.Lk)("p",null,[t[12]||(t[12]=(0,n.Lk)("strong",null,"Has User Profile:",-1)),(0,n.eW)(" "+(0,i.v_)(s.hasUserProfile?"Yes":"No"),1)])]),(0,n.Lk)("div",dn,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.forceLogout&&s.forceLogout(...e)),class:"btn btn-danger"},"Force Logout"),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.testBackend&&s.testBackend(...e)),class:"btn btn-primary"},"Test Backend Connection"),(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>s.testAuthenticatedEndpoint&&s.testAuthenticatedEndpoint(...e)),class:"btn btn-primary"},"Test Auth Endpoint")])])]),s.hasToken?((0,n.uX)(),(0,n.CE)("div",gn,[t[16]||(t[16]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"Token Information")],-1)),(0,n.Lk)("div",hn,[(0,n.Lk)("div",pn,[(0,n.Lk)("button",{onClick:t[3]||(t[3]=e=>s.activeTab="decoded"),class:(0,i.C4)([{active:"decoded"===s.activeTab},"tab-btn"])}," Decoded Token ",2),(0,n.Lk)("button",{onClick:t[4]||(t[4]=e=>s.activeTab="raw"),class:(0,i.C4)([{active:"raw"===s.activeTab},"tab-btn"])}," Raw Token ",2)]),(0,n.Lk)("div",mn,["decoded"===s.activeTab?((0,n.uX)(),(0,n.CE)("div",kn,[t[14]||(t[14]=(0,n.Lk)("h3",null,"Header",-1)),(0,n.Lk)("pre",null,(0,i.v_)(s.tokenHeader),1),t[15]||(t[15]=(0,n.Lk)("h3",null,"Payload",-1)),(0,n.Lk)("pre",null,(0,i.v_)(s.tokenPayload),1)])):(0,n.Q3)("",!0),"raw"===s.activeTab?((0,n.uX)(),(0,n.CE)("div",fn,[(0,n.Lk)("textarea",yn,(0,i.v_)(s.token),1),(0,n.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>s.copyToken&&s.copyToken(...e)),class:"btn btn-sm btn-secondary"},"Copy Token")])):(0,n.Q3)("",!0)])])])):(0,n.Q3)("",!0),(0,n.Lk)("div",vn,[t[17]||(t[17]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"API Connection Tests")],-1)),(0,n.Lk)("div",wn,[0===s.testResults.length?((0,n.uX)(),(0,n.CE)("div",Ln,' No test results yet. Click "Test Backend Connection" to begin testing. ')):((0,n.uX)(),(0,n.CE)("div",bn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.testResults,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:(0,i.C4)(["test-result",{"test-success":e.success,"test-error":!e.success}])},[(0,n.Lk)("div",Dn,[(0,n.Lk)("span",An,(0,i.v_)(e.title),1),(0,n.Lk)("span",Cn,(0,i.v_)(e.success?"Success":"Failed"),1)]),(0,n.Lk)("div",En,[(0,n.Lk)("pre",null,(0,i.v_)(s.formatResult(e.data)),1)])],2)))),128))]))])]),(0,n.Lk)("div",Sn,[t[18]||(t[18]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"Actions")],-1)),(0,n.Lk)("div",Pn,[(0,n.Lk)("div",Tn,[(0,n.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>s.clearLocalStorage&&s.clearLocalStorage(...e)),class:"btn btn-warning"},"Clear All Local Storage"),(0,n.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>s.goToLogin&&s.goToLogin(...e)),class:"btn btn-primary"},"Go to Login Page"),(0,n.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>s.goToAuthConfig&&s.goToAuthConfig(...e)),class:"btn btn-secondary"},"Auth0 Configuration Page")])])])])}const xn={name:"Debug",setup(){const e=(0,a.rd)(),t=(0,U.KR)(""),o=(0,U.KR)({}),s=(0,U.KR)({}),r=(0,U.KR)(!1),i=(0,U.KR)(!1),l=(0,U.KR)(!1),c=(0,U.KR)(0),u=(0,U.KR)("decoded"),d=(0,U.KR)([]),g=(0,n.EW)((()=>c.value?new Date(c.value).toLocaleString():"No expiry set")),h=(0,n.EW)((()=>{if(!c.value)return"N/A";const e=(new Date).getTime(),t=c.value;if(e>=t)return"Expired";const o=t-e,s=Math.floor(o/1e3/60),a=Math.floor(o/1e3%60);return`${s}m ${a}s`})),p=()=>{const e=localStorage.getItem("auth_token"),a=localStorage.getItem("user_profile"),n=localStorage.getItem("expires_at");if(i.value=!!e,l.value=!!a,c.value=n?JSON.parse(n):0,e){t.value=e;try{const t=e.split(".");3===t.length&&(o.value=JSON.parse(atob(t[0])),s.value=JSON.parse(atob(t[1])))}catch(u){console.error("Error parsing token:",u),d.value.push({title:"Token Parsing Error",success:!1,data:{error:u.message}})}}r.value=E.isAuthenticated()},m=async()=>{console.log("Testing backend connection..."),b.logApi("Testing backend connection");try{const e=await fetch("https://localhost:7250/api/health"),t=await e.json();return d.value.push({title:"Backend Health Check",success:e.ok,data:{status:e.status,statusText:e.statusText,responseData:t}}),e.ok}catch(e){return console.error("Error testing backend:",e),d.value.push({title:"Backend Connection Error",success:!1,data:{error:e.message,suggestion:"Make sure the backend API is running with: cd WorkoutTracker.Api && dotnet run --launch-profile https"}}),!1}},k=async()=>{console.log("Testing authenticated endpoint..."),b.logApi("Testing authenticated endpoint");try{const e=await fetch("https://localhost:7250/api/health/auth",{headers:{Authorization:`Bearer ${t.value}`}});if(e.ok){const t=await e.json();return d.value.push({title:"Authenticated Endpoint Test",success:!0,data:{status:e.status,statusText:e.statusText,responseData:t}}),!0}return 401===e.status?d.value.push({title:"Authentication Failed (401)",success:!1,data:{status:e.status,statusText:e.statusText,tokenAudience:s.value?.aud,tokenIssuer:s.value?.iss,tokenExpiry:s.value?.exp?new Date(1e3*s.value.exp).toLocaleString():"unknown",suggestion:"Token may be invalid or expired. Try logging out and logging in again."}}):d.value.push({title:"Authenticated Endpoint Error",success:!1,data:{status:e.status,statusText:e.statusText}}),!1}catch(e){return console.error("Error testing authenticated endpoint:",e),d.value.push({title:"Authenticated Endpoint Error",success:!1,data:{error:e.message}}),!1}},f=e=>JSON.stringify(e,null,2),y=()=>{navigator.clipboard.writeText(t.value).then((()=>{alert("Token copied to clipboard!")})).catch((e=>{console.error("Failed to copy token: ",e)}))},v=()=>{localStorage.clear(),alert("Local storage cleared. You will need to log in again."),p()},w=()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),localStorage.removeItem("user_profile"),localStorage.removeItem("user_state"),localStorage.removeItem("auth_state"),alert("You have been logged out."),p()},L=()=>{e.push("/login")},D=()=>{e.push("/auth-config")};return(0,n.sV)((()=>{p(),m()})),{token:t,tokenHeader:o,tokenPayload:s,isAuthenticated:r,hasToken:i,hasUserProfile:l,tokenExpiry:g,timeRemaining:h,activeTab:u,testResults:d,testBackend:m,testAuthenticatedEndpoint:k,formatResult:f,copyToken:y,clearLocalStorage:v,forceLogout:w,goToLogin:L,goToAuthConfig:D}}},Fn=(0,I.A)(xn,[["render",In],["__scopeId","data-v-8eadb7ba"]]),Un=Fn,_n={class:"auth-config"},Vn={class:"container"},$n={class:"card"},Nn={class:"card-body"},Mn={key:0,class:"alert alert-warning"},Wn={class:"config-section"},Gn={class:"config-value"},On={class:"config-section"},Rn={class:"config-value"},qn={class:"config-section"},Xn={class:"config-value"},Jn={class:"mt-4"};function jn(e,t,o,s,a,r){return(0,n.uX)(),(0,n.CE)("div",_n,[(0,n.Lk)("div",Vn,[(0,n.Lk)("div",$n,[t[19]||(t[19]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"Auth0 Configuration Helper")],-1)),(0,n.Lk)("div",Nn,[s.configIssue?((0,n.uX)(),(0,n.CE)("div",Mn,[t[5]||(t[5]=(0,n.Lk)("h5",null,[(0,n.Lk)("i",{class:"fas fa-exclamation-triangle"}),(0,n.eW)(" Auth0 Configuration Issue Detected")],-1)),(0,n.Lk)("p",null,(0,i.v_)(s.configIssueMessage),1)])):(0,n.Q3)("",!0),t[15]||(t[15]=(0,n.Lk)("h3",null,"Required Auth0 Configuration Settings",-1)),t[16]||(t[16]=(0,n.Lk)("p",null,"To ensure proper functioning of the application authentication flow, please configure the following settings in your Auth0 dashboard:",-1)),(0,n.Lk)("div",Wn,[t[7]||(t[7]=(0,n.Lk)("h4",null,"1. Allowed Callback URLs",-1)),(0,n.Lk)("div",Gn,[t[6]||(t[6]=(0,n.Lk)("code",null,"http://localhost:8080/callback",-1)),(0,n.Lk)("button",{class:"btn btn-sm btn-secondary copy-btn",onClick:t[0]||(t[0]=e=>s.copyToClipboard("http://localhost:8080/callback"))}," Copy ")]),t[8]||(t[8]=(0,n.Lk)("p",null,"This URL is used when returning from the Auth0 login page.",-1))]),(0,n.Lk)("div",On,[t[10]||(t[10]=(0,n.Lk)("h4",null,"2. Allowed Logout URLs",-1)),(0,n.Lk)("div",Rn,[t[9]||(t[9]=(0,n.Lk)("code",null,"http://localhost:8080",-1)),(0,n.Lk)("button",{class:"btn btn-sm btn-secondary copy-btn",onClick:t[1]||(t[1]=e=>s.copyToClipboard("http://localhost:8080"))}," Copy ")]),t[11]||(t[11]=(0,n.Lk)("p",null,"This URL is where users will be redirected after logging out.",-1))]),(0,n.Lk)("div",qn,[t[13]||(t[13]=(0,n.Lk)("h4",null,"3. Allowed Web Origins",-1)),(0,n.Lk)("div",Xn,[t[12]||(t[12]=(0,n.Lk)("code",null,"http://localhost:8080",-1)),(0,n.Lk)("button",{class:"btn btn-sm btn-secondary copy-btn",onClick:t[2]||(t[2]=e=>s.copyToClipboard("http://localhost:8080"))}," Copy ")]),t[14]||(t[14]=(0,n.Lk)("p",null,"This allows the application to make requests to Auth0.",-1))]),t[17]||(t[17]=(0,n.Lk)("h3",null,"How to Configure These Settings",-1)),t[18]||(t[18]=(0,n.Lk)("ol",null,[(0,n.Lk)("li",null,[(0,n.eW)("Log in to your "),(0,n.Lk)("a",{href:"https://manage.auth0.com",target:"_blank"},"Auth0 Dashboard")]),(0,n.Lk)("li",null,"Select your application"),(0,n.Lk)("li",null,'Navigate to the "Settings" tab'),(0,n.Lk)("li",null,"Scroll down to find each of the fields above"),(0,n.Lk)("li",null,"Add the provided URLs to each corresponding field"),(0,n.Lk)("li",null,'Click the "Save Changes" button at the bottom of the page')],-1)),(0,n.Lk)("div",Jn,[(0,n.Lk)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>s.returnToApp&&s.returnToApp(...e))}," Return to Application "),(0,n.Lk)("button",{class:"btn btn-outline-primary ml-2",onClick:t[4]||(t[4]=(...e)=>s.openAuth0Dashboard&&s.openAuth0Dashboard(...e))}," Open Auth0 Dashboard ")])])])])])}const Hn={name:"AuthConfig",setup(){const e=(0,a.rd)(),t=(0,U.KR)(!1),o=(0,U.KR)("");(0,n.sV)((()=>{const e=new URLSearchParams(window.location.search),s=e.get("error"),a=e.get("error_description");s&&(t.value=!0,"invalid_request"===s&&a&&a.includes("returnTo")?o.value='The logout URL is not properly configured in Auth0. Please add "http://localhost:8080" to the "Allowed Logout URLs" in your Auth0 application settings.':o.value=a||"An unknown Auth0 configuration issue was detected.")}));const s=e=>{navigator.clipboard.writeText(e).then((()=>{alert("Copied to clipboard!")})).catch((e=>{console.error("Failed to copy text: ",e)}))},r=()=>{e.push("/")},i=()=>{window.open("https://manage.auth0.com","_blank")};return{configIssue:t,configIssueMessage:o,copyToClipboard:s,returnToApp:r,openAuth0Dashboard:i}}},Bn=(0,I.A)(Hn,[["render",jn],["__scopeId","data-v-38d64fa2"]]),zn=Bn,Kn=[{path:"/",component:J},{path:"/login",component:te},{path:"/dashboard",component:qe,meta:{requiresAuth:!0}},{path:"/workout-plans",component:fo,meta:{requiresAuth:!0}},{path:"/workout-logs",component:Cs,meta:{requiresAuth:!0}},{path:"/goals",component:_a,meta:{requiresAuth:!0}},{path:"/profile",component:Qr,meta:{requiresAuth:!0}},{path:"/callback",component:rn},{path:"/debug",component:Un},{path:"/auth-config",component:zn}],Yn=(0,a.aE)({history:(0,a.LA)(),routes:Kn});Yn.beforeEach((async(e,t,o)=>{if(console.log(`NAVIGATION GUARD: ${t.path} → ${e.path} (requires auth: ${e.matched.some((e=>e.meta.requiresAuth))})`),b.logNavigation(`Route change: ${t.path} → ${e.path}`,{requiresAuth:e.matched.some((e=>e.meta.requiresAuth))}),"/login"===e.path)return console.log("Navigating to login page - access granted"),b.logNavigation("Login page access granted"),void o();if("/debug"===e.path)return console.log("Navigating to debug page - access granted"),b.logNavigation("Debug page access granted"),void o();const s="/callback"===t.path;if(s&&"/dashboard"===e.path)return console.log("SPECIAL CASE: Coming directly from callback to dashboard - allowing access"),b.logNavigation("Allowing direct callback → dashboard navigation"),void o();if(e.matched.some((e=>e.meta.requiresAuth))){console.log(`Protected route access attempt: ${e.path}`),b.logNavigation(`Protected route access: ${e.path}`);const s=localStorage.getItem("auth_token"),a=localStorage.getItem("id_token"),r=localStorage.getItem("expires_at"),n=localStorage.getItem("user_profile"),i=localStorage.getItem("user_state"),l=E.isAuthenticated(),c={isAuthenticated:l,hasAccessToken:!!s,hasIdToken:!!a,hasExpiresAt:!!r,hasUserProfile:!!n,hasUserState:!!i,currentPath:e.path,fromPath:t.path,userInStore:ti.state.user?"Present":"Missing",currentTime:(new Date).toLocaleString(),expiresAt:r?new Date(JSON.parse(r)).toLocaleString():"not set"};console.log("DETAILED AUTH CHECK:",c),b.logNavigation("Authentication check",c),s?(console.log("Access token exists, granting access to protected route"),b.logNavigation("Token exists, granting access"),ti.state.user||(console.log("User data not loaded, attempting to hydrate user data in background..."),b.logNavigation("Hydrating user data in background"),n?(console.log("Using cached user profile from localStorage"),ti.commit("setUser",JSON.parse(n))):ti.dispatch("fetchUser").catch((e=>{console.error("Background user data fetch failed:",e)}))),"/workout-plans"===e.path?(console.log("Refreshing workout plans data from API"),ti.dispatch("fetchWorkoutPlans").catch((e=>{console.error("Failed to fetch workout plans:",e)}))):"/workout-logs"===e.path?(console.log("Refreshing workout logs data from API"),ti.dispatch("fetchWorkoutLogs").catch((e=>{console.error("Failed to fetch workout logs:",e)}))):"/goals"===e.path?(console.log("Refreshing goals data from API"),ti.dispatch("fetchGoals").catch((e=>{console.error("Failed to fetch goals:",e)}))):"/dashboard"===e.path&&(console.log("Refreshing all data for dashboard"),Promise.all([ti.dispatch("fetchWorkoutPlans"),ti.dispatch("fetchWorkoutLogs"),ti.dispatch("fetchGoals"),ti.dispatch("fetchStats")]).catch((e=>{console.error("Failed to fetch dashboard data:",e)}))),o()):(console.log("ACCESS DENIED: No valid token, redirecting to login"),b.logNavigation("Access denied, redirecting to login"),o("/login"))}else console.log(`Public route access: proceeding to ${e.path}`),b.logNavigation(`Public route access: ${e.path}`),o()}));const Qn=e=>{try{const t={workoutPlans:e.workoutPlans||[],workoutLogs:e.workoutLogs||[],goals:e.goals||[],user:e.user,isAuthenticated:e.isAuthenticated};console.log("Saving state to localStorage:",t),console.log("workoutPlans count:",t.workoutPlans.length),console.log("workoutLogs count:",t.workoutLogs.length);const o=JSON.stringify(t);localStorage.setItem("workout_tracker_state",o),console.log("Store state saved to localStorage (size: "+o.length+" bytes)")}catch(t){console.error("Could not save state to localStorage:",t)}},Zn=()=>{try{const e=localStorage.getItem("workout_tracker_state");if(null===e)return void console.log("No saved state found in localStorage");const t=JSON.parse(e);return console.log("Loaded state from localStorage:",t),console.log("workoutPlans count:",t.workoutPlans?t.workoutPlans.length:0),console.log("workoutLogs count:",t.workoutLogs?t.workoutLogs.length:0),t}catch(e){return console.error("Could not load state from localStorage:",e),void localStorage.removeItem("workout_tracker_state")}},ei=Zn(),ti=(0,r.y$)({state(){const e=localStorage.getItem("user_state"),t=!!localStorage.getItem("auth_token"),o={user:e?JSON.parse(e):null,isAuthenticated:t,workoutPlans:[],workoutLogs:[],goals:[],stats:null,notification:{show:!1,message:"",type:"info",timeout:5e3},debug:{logs:[]}};return ei&&(console.log("Merging saved state with default state"),Array.isArray(ei.workoutPlans)&&(o.workoutPlans=ei.workoutPlans),Array.isArray(ei.workoutLogs)&&(o.workoutLogs=ei.workoutLogs),Array.isArray(ei.goals)&&(o.goals=ei.goals),ei.user&&(o.user=ei.user),o.isAuthenticated=t),o},mutations:{setUser(e,t){e.user=t,t?(localStorage.setItem("user_state",JSON.stringify(t)),e.isAuthenticated=!0):(localStorage.removeItem("user_state"),e.isAuthenticated=!1)},setAuthenticated(e,t){e.isAuthenticated=t},setWorkoutPlans(e,t){e.workoutPlans=Array.isArray(t)?t:[]},addWorkoutPlan(e,t){Array.isArray(e.workoutPlans)||(e.workoutPlans=[]),e.workoutPlans.push(t)},updateWorkoutPlan(e,t){if(!Array.isArray(e.workoutPlans))return void(e.workoutPlans=[]);const o=e.workoutPlans.findIndex((e=>e.id===t.id));-1!==o&&e.workoutPlans.splice(o,1,t)},removeWorkoutPlan(e,t){Array.isArray(e.workoutPlans)?e.workoutPlans=e.workoutPlans.filter((e=>e.id!==t)):e.workoutPlans=[]},setWorkoutLogs(e,t){e.workoutLogs=Array.isArray(t)?t:[]},addWorkoutLog(e,t){Array.isArray(e.workoutLogs)||(e.workoutLogs=[]),e.workoutLogs.push(t)},updateWorkoutLog(e,t){if(!Array.isArray(e.workoutLogs))return void(e.workoutLogs=[]);const o=e.workoutLogs.findIndex((e=>e.id===t.id));-1!==o&&e.workoutLogs.splice(o,1,t)},removeWorkoutLog(e,t){Array.isArray(e.workoutLogs)?e.workoutLogs=e.workoutLogs.filter((e=>e.id!==t)):e.workoutLogs=[]},setGoals(e,t){e.goals=Array.isArray(t)?t:[]},addGoal(e,t){Array.isArray(e.goals)||(e.goals=[]),e.goals.push(t)},updateGoal(e,t){if(!Array.isArray(e.goals))return void(e.goals=[]);const o=e.goals.findIndex((e=>e.id===t.id));-1!==o&&e.goals.splice(o,1,t)},removeGoal(e,t){Array.isArray(e.goals)?e.goals=e.goals.filter((e=>e.id!==t)):e.goals=[]},setStats(e,t){e.stats=t},showNotification(e,{message:t,type:o="info",timeout:s=5e3}){e.notification={show:!0,message:t,type:o,timeout:s}},hideNotification(e){e.notification.show=!1}},actions:{async fetchUser({commit:e}){try{const t=await E.getUser();return e("setUser",t),e("setAuthenticated",!!t),t}catch(t){return console.error("Failed to fetch user:",t),e("setAuthenticated",!1),null}},async logout({commit:e}){e("setUser",null),e("setAuthenticated",!1),e("setWorkoutPlans",[]),e("setWorkoutLogs",[]),e("setGoals",[]),e("setStats",null),E.logout(),this.dispatch("showMessage",{message:"You have been logged out",type:"info",timeout:3e3})},async fetchWorkoutPlans({commit:e}){try{const t=await po.get("WorkoutPlans");console.log("Raw workout plans response:",t);let o=[];t&&"object"===typeof t&&(Array.isArray(t)?(console.log("Response is a standard array"),o=t):t.$values?(console.log("Response has $values at root level"),o=t.$values):t.$id&&Array.isArray(t.$values)&&(console.log("Response has $id and $values properties"),o=t.$values)),console.log("Processed workout plans:",o),e("setWorkoutPlans",o)}catch(t){throw console.error("Failed to fetch workout plans:",t),t}},async createWorkoutPlan({commit:e},t){try{const o=await po.post("WorkoutPlans",t);return e("addWorkoutPlan",o),o}catch(o){throw console.error("Failed to create workout plan:",o),o}},async updateWorkoutPlan({commit:e},t){try{const o=await po.put(`WorkoutPlans/${t.id}`,t);return e("updateWorkoutPlan",o),o}catch(o){throw console.error("Failed to update workout plan:",o),o}},async deleteWorkoutPlan({commit:e},t){try{await po.delete(`WorkoutPlans/${t}`),e("removeWorkoutPlan",t)}catch(o){throw console.error("Failed to delete workout plan:",o),o}},async fetchWorkoutLogs({commit:e}){try{const t=await po.get("WorkoutLogs");console.log("Raw workout logs response:",t);let o=[];t&&"object"===typeof t&&(Array.isArray(t)?(console.log("Response is a standard array"),o=t):t.$values?(console.log("Response has $values at root level"),o=t.$values):t.$id&&Array.isArray(t.$values)&&(console.log("Response has $id and $values properties"),o=t.$values)),console.log("Processed workout logs:",o),e("setWorkoutLogs",o)}catch(t){throw console.error("Failed to fetch workout logs:",t),t}},async createWorkoutLog({commit:e},t){try{console.log("Creating workout log with data:",JSON.stringify(t)),t.workoutDate?console.log(`Original workoutDate: ${t.workoutDate}`):console.warn("workoutDate is missing from logData!");const o={workoutLog:t};console.log("Formatted data to send to API:",JSON.stringify(o));const s=await po.post("WorkoutLogs",o);return e("addWorkoutLog",s),s}catch(o){throw console.error("Failed to create workout log:",o),o.response&&console.error("Server response:",o.response.data),o}},async updateWorkoutLog({commit:e},t){try{console.log("Updating workout log with data:",JSON.stringify(t)),t.workoutDate?console.log(`Original workoutDate: ${t.workoutDate}`):console.warn("workoutDate is missing from logData!");const o={workoutLog:t};console.log("Formatted data to send to API:",JSON.stringify(o));const s=await po.put(`WorkoutLogs/${t.id}`,o);return e("updateWorkoutLog",s),s}catch(o){throw console.error("Failed to update workout log:",o),o.response&&console.error("Server response:",o.response.data),o}},async deleteWorkoutLog({commit:e},t){try{await po.delete(`WorkoutLogs/${t}`),e("removeWorkoutLog",t)}catch(o){throw console.error("Failed to delete workout log:",o),o}},async fetchGoals({commit:e}){try{const t=await po.get("Goals");console.log("Goals response from API:",t);let o=[];if(Array.isArray(t))o=t.map((e=>({id:e.Id||e.id,name:e.Name||e.name,description:e.Description||e.description,startDate:e.StartDate||e.startDate,targetDate:e.TargetDate||e.targetDate,startingValue:e.StartingValue||e.startingValue,currentValue:e.CurrentValue||e.currentValue,targetValue:e.TargetValue||e.targetValue,metricType:e.MetricType||e.metricType,unit:e.Unit||e.unit,isCompleted:e.IsCompleted||e.isCompleted,user:e.User||e.user})));else if(t&&"object"===typeof t)if(console.warn("Response is not an array, but an object:",t),Array.isArray(t.$values))o=t.$values.map((e=>({id:e.Id||e.id,name:e.Name||e.name,description:e.Description||e.description,startDate:e.StartDate||e.startDate,targetDate:e.TargetDate||e.targetDate,startingValue:e.StartingValue||e.startingValue,currentValue:e.CurrentValue||e.currentValue,targetValue:e.TargetValue||e.targetValue,metricType:e.MetricType||e.metricType,unit:e.Unit||e.unit,isCompleted:e.IsCompleted||e.isCompleted,user:e.User||e.user})));else if(t.Id||t.id){const e=t;o=[{id:e.Id||e.id,name:e.Name||e.name,description:e.Description||e.description,startDate:e.StartDate||e.startDate,targetDate:e.TargetDate||e.targetDate,startingValue:e.StartingValue||e.startingValue,currentValue:e.CurrentValue||e.currentValue,targetValue:e.TargetValue||e.targetValue,metricType:e.MetricType||e.metricType,unit:e.Unit||e.unit,isCompleted:e.IsCompleted||e.isCompleted,user:e.User||e.user}]}console.log("Processed goals to be stored in state:",o),e("setGoals",o)}catch(t){throw console.error("Failed to fetch goals:",t),t}},async createGoal({commit:e},t){try{if(t.Name){console.log("Using pre-formatted goal data with capitalized field names:",t),console.log("Sending data to API as root level object:",JSON.stringify(t,null,2));const o=await po.post("Goals",t);console.log("Goal creation response:",o);const s={id:o.Id||o.id,name:o.Name||o.name,description:o.Description||o.description,startDate:o.StartDate||o.startDate,targetDate:o.TargetDate||o.targetDate,startingValue:o.StartingValue||o.startingValue,currentValue:o.CurrentValue||o.currentValue,targetValue:o.TargetValue||o.targetValue,metricType:o.MetricType||o.metricType,unit:o.Unit||o.unit,isCompleted:o.IsCompleted||o.isCompleted,user:o.User||o.user};return e("addGoal",s),s}{if(console.log("Original goal data:",JSON.stringify(t,null,2)),!t.name)throw new Error("Goal name is required");if(!t.targetValue)throw new Error("Goal target value is required");if(!t.startDate||!t.targetDate)throw new Error("Goal start and target dates are required");!t.startDate||"string"===typeof t.startDate&&t.startDate.includes("T")||(t.startDate=new Date(t.startDate).toISOString()),!t.targetDate||"string"===typeof t.targetDate&&t.targetDate.includes("T")||(t.targetDate=new Date(t.targetDate).toISOString());const o={Id:void 0!==t.id&&null!==t.id&&parseInt(t.id,10)||null,Name:t.name,Description:t.description||"Goal created from workout tracker",StartDate:t.startDate,TargetDate:t.targetDate,StartingValue:t.startingValue,CurrentValue:t.currentValue,TargetValue:t.targetValue,MetricType:t.metricType,Unit:t.unit,IsCompleted:t.isCompleted||!1,User:{Auth0Id:localStorage.getItem("user_profile")?JSON.parse(localStorage.getItem("user_profile")).sub:null}};console.log("Sending formatted goal data to API:",JSON.stringify(o,null,2));const s=await po.post("Goals",o);console.log("Goal creation response:",s);const a={id:s.Id||s.id,name:s.Name||s.name,description:s.Description||s.description,startDate:s.StartDate||s.startDate,targetDate:s.TargetDate||s.targetDate,startingValue:s.StartingValue||s.startingValue,currentValue:s.CurrentValue||s.currentValue,targetValue:s.TargetValue||s.targetValue,metricType:s.MetricType||s.metricType,unit:s.Unit||s.unit,isCompleted:s.IsCompleted||s.isCompleted,user:s.User||s.user};return e("addGoal",a),a}}catch(o){throw console.error("Failed to create goal:",o),o}},async updateGoal({commit:e},t){try{if(t.Name){console.log("Using pre-formatted goal data with capitalized field names:",t),console.log("Sending data to API as root level object:",JSON.stringify(t,null,2));const o=await po.put(`Goals/${t.Id}`,t),s={id:o.Id||o.id,name:o.Name||o.name,description:o.Description||o.description,startDate:o.StartDate||o.startDate,targetDate:o.TargetDate||o.targetDate,startingValue:o.StartingValue||o.startingValue,currentValue:o.CurrentValue||o.currentValue,targetValue:o.TargetValue||o.targetValue,metricType:o.MetricType||o.metricType,unit:o.Unit||o.unit,isCompleted:o.IsCompleted||o.isCompleted,user:o.User||o.user};return e("updateGoal",s),s}{console.log("Original goal data for update:",JSON.stringify(t,null,2));const o={Id:parseInt(t.id,10),Name:t.name,Description:t.description||"Goal updated from workout tracker",StartDate:"string"===typeof t.startDate&&t.startDate.includes("T")?t.startDate:new Date(t.startDate).toISOString(),TargetDate:"string"===typeof t.targetDate&&t.targetDate.includes("T")?t.targetDate:new Date(t.targetDate).toISOString(),StartingValue:t.startingValue,CurrentValue:t.currentValue,TargetValue:t.targetValue,MetricType:t.metricType,Unit:t.unit,IsCompleted:t.isCompleted||!1,User:{Auth0Id:localStorage.getItem("user_profile")?JSON.parse(localStorage.getItem("user_profile")).sub:null}};console.log("Sending formatted goal update data to API:",JSON.stringify(o,null,2));const s=await po.put(`Goals/${o.Id}`,o),a={id:s.Id||s.id,name:s.Name||s.name,description:s.Description||s.description,startDate:s.StartDate||s.startDate,targetDate:s.TargetDate||s.targetDate,startingValue:s.StartingValue||s.startingValue,currentValue:s.CurrentValue||s.currentValue,targetValue:s.TargetValue||s.targetValue,metricType:s.MetricType||s.metricType,unit:s.Unit||s.unit,isCompleted:s.IsCompleted||s.isCompleted,user:s.User||s.user};return e("updateGoal",a),a}}catch(o){throw console.error("Failed to update goal:",o),o}},async updateGoalProgress({commit:e,dispatch:t},o){try{const e=parseInt(o.goalId,10);if(isNaN(e)||e<=0)throw console.error("Invalid goal ID for progress update:",o.goalId),new Error("Invalid goal ID");const s={CurrentValue:o.currentValue,Date:"string"===typeof o.date&&o.date.includes("T")?o.date:new Date(o.date).toISOString(),Notes:o.notes||""};console.log(`Updating progress for goal ${e}:`,JSON.stringify(s,null,2));const a="/api",r=`${a}/Goals/${e}/progress`;console.log("Progress update API URL:",r);const n=await po.post(`Goals/${e}/progress`,s);return console.log("Goal progress update successful:",n),await t("fetchGoals"),n}catch(s){throw console.error(`Failed to update goal progress for goal ID ${o.goalId}:`,s),s.response?(console.error("Response data:",s.response.data),console.error("Response status:",s.response.status),console.error("Response headers:",s.response.headers)):s.request?console.error("Request made but no response received. Network issue?",s.request):console.error("Error setting up request:",s.message),s}},async deleteGoal({commit:e},t){try{await po.delete(`Goals/${t}`),e("removeGoal",t)}catch(o){throw console.error("Failed to delete goal:",o),o}},async fetchStats({commit:e}){try{const t=await po.get("Stats/summary");e("setStats",t)}catch(t){throw console.error("Failed to fetch stats:",t),t}},async fetchChartData({commit:e},t){try{const e=await po.get(`Stats/${t}`);return e}catch(o){throw console.error(`Failed to fetch chart data (${t}):`,o),o}},showMessage({commit:e},{message:t,type:o,timeout:s}){e("showNotification",{message:t,type:o,timeout:s}),setTimeout((()=>{e("hideNotification")}),s)},async refreshAllData(){return console.log("Refreshing all data from API"),Promise.all([this.dispatch("fetchWorkoutPlans"),this.dispatch("fetchWorkoutLogs"),this.dispatch("fetchGoals"),this.dispatch("fetchStats")]).catch((e=>(console.error("Error refreshing all data:",e),Promise.reject(e))))}}});ti.subscribe(((e,t)=>{console.log("Store mutation detected:",e.type),(e.type.startsWith("set")||e.type.startsWith("add")||e.type.startsWith("update")||e.type.startsWith("remove"))&&setTimeout((()=>{Qn(t)}),0)})),ti.dispatch=function(e){return function(t,o){return"refreshAllData"===t?(console.log("Refreshing all data from API"),Promise.all([e("fetchWorkoutPlans"),e("fetchWorkoutLogs"),e("fetchGoals"),e("fetchStats")]).catch((e=>(console.error("Error refreshing all data:",e),Promise.reject(e))))):e(t,o)}}(ti.dispatch),so.init(ti);const oi=(0,s.Ef)($);oi.use(Yn),oi.use(ti),oi.mount("#app"),E.isAuthenticated()&&(console.log("User is authenticated, loading initial data"),ti.dispatch("refreshAllData").catch((e=>{console.error("Failed to load initial data:",e)})))}},t={};function o(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,o),r.exports}o.m=e,(()=>{var e=[];o.O=(t,s,a,r)=>{if(!s){var n=1/0;for(u=0;u<e.length;u++){for(var[s,a,r]=e[u],i=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(o.O).every((e=>o.O[e](s[l])))?s.splice(l--,1):(i=!1,r<n&&(n=r));if(i){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[s,a,r]}})(),(()=>{o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};o.O.j=t=>0===e[t];var t=(t,s)=>{var a,r,[n,i,l]=s,c=0;if(n.some((t=>0!==e[t]))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(l)var u=l(o)}for(t&&t(s);c<n.length;c++)r=n[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},s=self["webpackChunkworkouttracker_client"]=self["webpackChunkworkouttracker_client"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=o.O(void 0,[504],(()=>o(139)));s=o.O(s)})();
//# sourceMappingURL=app.f08d47fa.js.map